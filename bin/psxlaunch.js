#! /usr/bin/env node  
!function(e){"use strict";var t,s=function(){return it.__string_rec(this,"")},b=b||{};function i(t,e){var s=Object.create(t);for(var i in e)s[i]=e[i];return e.toString!==Object.prototype.toString&&(s.toString=e.toString),s}var c=function(t,e){this.r=new RegExp(t,e.split("u").join(""))};c.__name__="EReg",c.prototype={match:function(t){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(t),this.r.s=t,null!=this.r.m},matched:function(t){if(null!=this.r.m&&0<=t&&t<this.r.m.length)return this.r.m[t];throw new st("EReg::matched")},matchedPos:function(){if(null==this.r.m)throw new st("No string matched");return{pos:this.r.m.index,len:this.r.m[0].length}},matchSub:function(t,e,s){if(null==s&&(s=-1),this.r.global){this.r.lastIndex=e,this.r.m=this.r.exec(s<0?t:g.substr(t,0,e+s));var i=null!=this.r.m;return i&&(this.r.s=t),i}var n=this.match(s<0?g.substr(t,e,null):g.substr(t,e,s));return n&&(this.r.s=t,this.r.m.index+=e),n},map:function(t,e){for(var s=0,i="";!(s>=t.length);){if(!this.matchSub(t,s)){i+=j.string(g.substr(t,s,null));break}var n=this.matchedPos();if(i+=j.string(g.substr(t,s,n.pos-s)),i+=j.string(e(this)),s=0==n.len?(i+=j.string(g.substr(t,n.pos,1)),n.pos+1):n.pos+n.len,!this.r.global)break}return!this.r.global&&0<s&&s<t.length&&(i+=j.string(g.substr(t,s,null))),i},__class__:c};var u=function(){this.mountedPath=null,this.index=-1,this.flag_use_ramdrive=!1};u.__name__="Engine",u.NPM_install=function(){var t=ht.dirname(__filename),e=ht.join(t,u.file_config),s=ht.join(t,u.file_config_empty);ot.existsSync(e)||v.copyFile(s,e)},u.getConfigFullpath=function(){var t=ht.dirname(__filename);return ht.join(t,u.file_config)},u.prototype={get_list_names:function(){for(var t=[],e=0,s=this.list_games;e<s.length;){var i=s[e];++e,t.push(i.name)}return t},get_gameName:function(){return this.list_games[this.index].name},init:function(){try{this.loadSettingsFile(),this.scanDirectories(),this.checkAutorun()}catch(t){var e=t instanceof st?t.val:t;if("string"==typeof e)return this.ERROR=e,!1;if(e instanceof Error){return!(this.ERROR="Config file Parse Error.")}throw t}return!0},anySavesRAM:function(){return 0<this.saves_ram.length},anySavesLOCAL:function(){return 0<this.saves_local.length},loadSettingsFile:function(){var t=new et;t.read(ot.readFileSync(ht.join(ht.dirname(process.argv[1]),u.file_config),{encoding:"utf8"}));var e=t.getAll("settings");if(this.string_size=null!=xt.size?e.getReserved("size"):e.h.size,this.path_isos=ht.normalize(null!=xt.isos?e.getReserved("isos"):e.h.isos),this.path_mednafen=ht.normalize(null!=xt.mednafen?e.getReserved("mednafen"):e.h.mednafen),this.path_ramdrive=ht.normalize(null!=xt.ramdrive?e.getReserved("ramdrive"):e.h.ramdrive),this.path_autorun=ht.normalize(null!=xt.autorun?e.getReserved("autorun"):e.h.autorun),this.setting_autosave=1==j.parseInt(null!=xt.autosave?e.getReserved("autosave"):e.h.autosave),this.path_isos.length<2)throw new st("ISOPATH not set");if(this.path_mednafen.length<2)throw new st("MEDNAFEN PATH not set");if(!v.pathExists(this.path_isos))throw new st("ISOPATH `"+this.path_isos+"` does not exist");if(!v.pathExists(this.path_mednafen))throw new st("MEDNAFEN PATH `"+this.path_mednafen+"` does not exist");if(!v.pathExists(ht.join(this.path_mednafen,u.MEDNAFEN_EXE)))throw new st("Can't find \""+u.MEDNAFEN_EXE+'" in "'+this.path_mednafen+'"');(this.flag_use_ramdrive=1<this.path_ramdrive.length)&&v.createRecursiveDir(this.path_ramdrive)},scanDirectories:function(){this.list_games=[];for(var t=[],e=v.getFileListFromDirR(this.path_isos,u.extensionsToSearch),s=0;s<e.length;){var i=e[s];++s;var n={name:ht.basename(i,ht.extname(i)),path:i,ext:g.substr(ht.extname(i).toLowerCase(),1,null)};this.list_games.push(n),"m3u"==v.getFileExt(i)&&t.push(i)}for(var r=0;r<t.length;){var o=t[r];++r;for(var l=ot.readFileSync(o).toString().split(lt.EOL),a=0;a<l.length;){var h=l[a];++a;for(var c=this.list_games.length;0<=--c;)this.list_games[c].name==ht.basename(h,ht.extname(h))&&this.list_games.splice(c,1)}}this.list_games.sort(function(t,e){return g.cca(t.name.toLowerCase(),0)-g.cca(e.name.toLowerCase(),0)})},launchGame:function(){var t=this.list_games[this.index];if(this.isZIP){this.mountedPath=this.mount_zip(t.path);for(var e=null,s=0,i=v.getFileListFromDir(this.mountedPath);s<i.length;){var n=i[s];++s;var r=v.getFileExt(n);if("cue"==r)e=n;else if("m3u"==r){e=n;break}}if(null==e)return this.ERROR="Archive Error.",this.unmount(this.mountedPath),!1;this.startMednafen(ht.join(this.mountedPath,e))}else this.mountedPath=null,this.startMednafen(t.path);return!0},startMednafen:function(t){var i=this;nt.exec("START /I "+u.MEDNAFEN_EXE+' "'+t+'"',{cwd:this.path_mednafen},function(t,e,s){null!=i.mountedPath&&i.unmount(i.mountedPath),null!=i.onMednafenExit&&i.onMednafenExit()})},copySave_LocalToRam:function(){if(0!=this.saves_local.length){for(var t=0,e=this.saves_local.length,s=0,i=this.saves_local;s<i.length;){var n=i[s];++s;var r=ht.join(this.path_ramdrive,ht.basename(n));v.pathExists(r)||(v.copyFile(n,r),++t)}this.OPLOG="Copied ("+t+"/"+e+") saves to RAM"}},copySave_RamToLocal:function(){if(0!=this.saves_ram.length){for(var t=0,e=this.saves_ram.length,s=0,i=this.saves_ram;s<i.length;){var n,r=i[s];++s,n="mcr"==v.getFileExt(r)?ht.join(this.path_mednafen,"sav",ht.basename(r)):ht.join(this.path_mednafen,"mcs",ht.basename(r)),v.pathExists(n)&&this.filesAreSame(r,n)||(v.copyFile(r,n),++t)}this.OPLOG="Copied ("+t+"/"+e+") saves to LOCAL"}},deleteGameSaves_fromRam:function(){for(var t=0,e=0,s=this.saves_ram;e<s.length;){var i=s[e];++e,ot.unlinkSync(i),++t}this.saves_ram=[],this.OPLOG="Deleted ("+t+") saves from RAM"},deleteGameStates_fromEveryWhere:function(){for(var t=0,e=this.saves_ram.concat(this.saves_local),s=0;s<e.length;){var i=e[s];++s,new c("(.*\\d)$","i").match(i)&&(ot.unlinkSync(i),++t)}this.OPLOG="Deleted ("+t+") STATES from RAM & LOCAL"},deleteEverything_fromRam:function(){},getLocalSaves:function(t){var e=[],s=ht.join(this.path_mednafen,"sav",this.list_games[t].name+".0.mcr");v.pathExists(s)&&e.push(s);var i=ht.join(this.path_mednafen,"sav",this.list_games[t].name+".1.mcr");v.pathExists(i)&&e.push(i);var n=ht.join(this.path_mednafen,"mcs",this.list_games[t].name+".mc0");v.pathExists(n)&&e.push(n);var r=ht.join(this.path_mednafen,"mcs",this.list_games[t].name+".mc1");v.pathExists(r)&&e.push(r);var o=ht.join(this.path_mednafen,"mcs",this.list_games[t].name+".mc2");v.pathExists(o)&&e.push(o);var l=ht.join(this.path_mednafen,"mcs",this.list_games[t].name+".mc3");v.pathExists(l)&&e.push(l);var a=ht.join(this.path_mednafen,"mcs",this.list_games[t].name+".mc4");v.pathExists(a)&&e.push(a);var h=ht.join(this.path_mednafen,"mcs",this.list_games[t].name+".mc5");v.pathExists(h)&&e.push(h);var c=ht.join(this.path_mednafen,"mcs",this.list_games[t].name+".mc6");v.pathExists(c)&&e.push(c);var u=ht.join(this.path_mednafen,"mcs",this.list_games[t].name+".mc7");v.pathExists(u)&&e.push(u);var _=ht.join(this.path_mednafen,"mcs",this.list_games[t].name+".mc8");v.pathExists(_)&&e.push(_);var d=ht.join(this.path_mednafen,"mcs",this.list_games[t].name+".mc9");return v.pathExists(d)&&e.push(d),e},getRamSaves:function(t){var e=[];if(!this.flag_use_ramdrive)return e;var s=ht.join(this.path_ramdrive,this.list_games[t].name+".0.mcr");v.pathExists(s)&&e.push(s);var i=ht.join(this.path_ramdrive,this.list_games[t].name+".1.mcr");v.pathExists(i)&&e.push(i);var n=ht.join(this.path_ramdrive,this.list_games[t].name+".mc0");v.pathExists(n)&&e.push(n);var r=ht.join(this.path_ramdrive,this.list_games[t].name+".mc1");v.pathExists(r)&&e.push(r);var o=ht.join(this.path_ramdrive,this.list_games[t].name+".mc2");v.pathExists(o)&&e.push(o);var l=ht.join(this.path_ramdrive,this.list_games[t].name+".mc3");v.pathExists(l)&&e.push(l);var a=ht.join(this.path_ramdrive,this.list_games[t].name+".mc4");v.pathExists(a)&&e.push(a);var h=ht.join(this.path_ramdrive,this.list_games[t].name+".mc5");v.pathExists(h)&&e.push(h);var c=ht.join(this.path_ramdrive,this.list_games[t].name+".mc6");v.pathExists(c)&&e.push(c);var u=ht.join(this.path_ramdrive,this.list_games[t].name+".mc7");v.pathExists(u)&&e.push(u);var _=ht.join(this.path_ramdrive,this.list_games[t].name+".mc8");v.pathExists(_)&&e.push(_);var d=ht.join(this.path_ramdrive,this.list_games[t].name+".mc9");return v.pathExists(d)&&e.push(d),e},prepareGame:function(t){this.index=t,this.current=this.list_games[this.index],this.saves_local=this.getLocalSaves(t),this.saves_ram=this.getRamSaves(t),this.isZIP=0<=u.extensionsToMount.indexOf(this.current.ext);this.isZIP},fixCheats:function(){var t=ht.join(this.path_mednafen,"cheats","psx.tmpcht"),e=ht.join(this.path_mednafen,"cheats","psx.cht");v.pathExists(t)?(v.copyFile(t,e),ot.unlinkSync(t),this.OPLOG="Cheat file written [OK]"):this.OPLOG="No need to fix"},checkAutorun:function(){if(!(this.path_autorun.length<2)){var t=ht.basename(this.path_autorun);if(0==x.getTaskPIDs(t).length){nt.exec("START /I "+this.path_autorun,function(t,e,s){});this.OPLOG='Launched "'+t+'" [OK]'}else this.OPLOG='"'+t+'" Already running'}},info:function(){this.index},filesAreSame:function(t,e){return v.getFileMD5(t)==v.getFileMD5(e)},mount_zip:function(t){try{nt.execSync(u.PSIMO_EXE+' mount "'+t+'"')}catch(t){t instanceof st&&t.val}var e=nt.execSync(u.PSIMO_EXE+' list "'+t+'"'),s=new c(".*\\.zip|pfo (.*)","ig");return s.match(e)?s.matched(1):null},unmount:function(t){try{nt.execSync(u.PSIMO_EXE+' unmount "'+t+'"')}catch(t){t instanceof st&&t.val}},__class__:u,__properties__:{get_gameName:"get_gameName",get_list_names:"get_list_names"}};var g=function(){};g.__name__="HxOverrides",g.dateStr=function(t){var e=t.getMonth()+1,s=t.getDate(),i=t.getHours(),n=t.getMinutes(),r=t.getSeconds();return t.getFullYear()+"-"+(e<10?"0"+e:""+e)+"-"+(s<10?"0"+s:""+s)+" "+(i<10?"0"+i:""+i)+":"+(n<10?"0"+n:""+n)+":"+(r<10?"0"+r:""+r)},g.cca=function(t,e){var s=t.charCodeAt(e);if(s==s)return s},g.substr=function(t,e,s){if(null==s)s=t.length;else if(s<0){if(0!=e)return"";s=t.length+s}return t.substr(e,s)},g.remove=function(t,e){var s=t.indexOf(e);return-1!=s&&(t.splice(s,1),!0)};var o=function(){this.argsAction=null,this.argsOptions={},this.argsOutput=null,this.argsInput=[],this.ARGS={inputRule:"opt",outputRule:"opt",requireAction:!1,supportWildcards:!0,supportStrayArgs:!1,helpInput:null,helpOutput:null,Actions:[],Options:[]},this.PROGRAM_INFO={name:"nodeJS Application",version:"0.1"},this.HELP_MARGIN=12;var e=this;w.init(),o.TERMINAL=new m,this.T=o.TERMINAL,process.once("exit",function(t){w.log("==> [EXIT] with code "+t,null,{fileName:"djNode/BaseApp.hx",lineNumber:104,className:"djNode.BaseApp",methodName:"new"}),e.onExit()}),process.once("SIGINT",function(){process.exit(1)}),process.once("uncaughtException",function(t){w.log("-------- !! Critical Error !! --------",4,{fileName:"djNode/BaseApp.hx",lineNumber:123,className:"djNode.BaseApp",methodName:"new"}),t instanceof Error?(w.log(t.stack,4,{fileName:"djNode/BaseApp.hx",lineNumber:127,className:"djNode.BaseApp",methodName:"new"}),e.exitError(t.message)):(w.log(t,4,{fileName:"djNode/BaseApp.hx",lineNumber:131,className:"djNode.BaseApp",methodName:"new"}),e.exitError(t))});try{this.init()}catch(t){var s=t instanceof st?t.val:t;if("string"!=typeof s)throw t;var i=s;this.printBanner(!0),"HELP"==i&&(this.printHelp(),process.exit(0)),this.exitError(i,!0)}w.log("- Inputs : "+this.argsInput.join(", "),null,{fileName:"djNode/BaseApp.hx",lineNumber:149,className:"djNode.BaseApp",methodName:"new"}),w.log("- Output : "+this.argsOutput,null,{fileName:"djNode/BaseApp.hx",lineNumber:150,className:"djNode.BaseApp",methodName:"new"}),w.log("- Action  set : "+this.argsAction,null,{fileName:"djNode/BaseApp.hx",lineNumber:151,className:"djNode.BaseApp",methodName:"new"}),w.log("- Options set : ",null,{fileName:"djNode/BaseApp.hx",lineNumber:152,className:"djNode.BaseApp",methodName:"new"});for(var t=0,n=a.fields(this.argsOptions);t<n.length;){var r=n[t];++t,w.log("\t\t"+r+" : "+j.string(a.getProperty(this.argsOptions,r)),null,{fileName:"djNode/BaseApp.hx",lineNumber:154,className:"djNode.BaseApp",methodName:"new"})}w.log("-------------",null,{fileName:"djNode/BaseApp.hx",lineNumber:156,className:"djNode.BaseApp",methodName:"new"}),this.onStart()};o.__name__="djNode.BaseApp",o.prototype={init:function(){this.T;process.stdout.write("[0m"),this.ARGS.Options.unshift(["-o","-output","","yes"]);var t=this.PROGRAM_INFO,e=this.ARGS;w.log("Creating Application [ "+t.name+" ,v"+t.version+" ]",null,{fileName:"djNode/BaseApp.hx",lineNumber:180,className:"djNode.BaseApp",methodName:"init"});for(var s,i=0,n=process.argv.slice(2);null!=(s=n[i++]);)if("-"!=s.charAt(0)){var r=this.getArgAction(s);if(null==r)this.argsInput.push(s);else{if(null!=this.argsAction)throw new st("You can only set one <action>");this.argsAction=r[0]}}else{if(0==s.toLowerCase().indexOf("-help"))throw new st("HELP");var o=this.getArgOption(s);if(null==o)throw new st("Illegal argument ["+s+"]");if(null!=o[3]){var l=n[i++];if(null==l||null!=this.getArgOption(l))throw new st("Argument ["+s+"] requires a parameter");this.argsOptions[g.substr(o[0],1,null)]=l}else this.argsOptions[g.substr(o[0],1,null)]=!0}null!=this.argsOptions.o&&(this.argsOutput=this.argsOptions.o);for(var a=0,h=this.argsInput;a<h.length;){var c=h[a];if(++a,0<=c.indexOf("*")){if(1<this.argsInput.length)throw new st("Multiple Inputs with wildcards are not supported");if(this.argsInput=v.getFileListFromWildcard(c),0==this.argsInput.length)throw new st("Wildcard `"+c+"` returned 0 files");break}}if(null==this.argsAction&&0<this.argsInput.length){var u=this.getArgAction(null,g.substr(ht.extname(this.argsInput[0].toLowerCase()),1,null));null!=u&&(this.argsAction=u[0])}if(0==this.argsInput.length&&0<=["yes","multi"].indexOf(e.inputRule))throw new st("Input is required");if(null==this.argsOutput&&"yes"==e.outputRule)throw new st("Output is required");if(e.requireAction&&null==this.argsAction)throw new st("Setting an action is required");for(var _=0,d=this.ARGS.Options;_<d.length;){var f=d[_];if(++_,null==f[3]){var p=g.substr(f[0],1,null);Object.prototype.hasOwnProperty.call(this.argsOptions,p)||(this.argsOptions[p]=!1)}}},onStart:function(){},onExit:function(){w.end();this.T;process.stdout.write("[0m"),this.T.cursorShow()},waitKeyQuit:function(){this.T.fg("darkgray");process.stdout.write("\n");process.stdout.write("Press any key to quit.\n");this.T;process.stdout.write("[0m"),p.startCapture(!0,function(t){process.exit(0)})},printHelp:function(){var i=this,n=function(t){return V.lpad(""," ",t)},t=this.ARGS,e=this.PROGRAM_INFO,s=function(t){return"opt"==t?"is optional.":"is required."},r=function(t){if(null!=t&&0<t.length){var e=new RegExp("(\n)","g".split("u").join("")),s="\n "+n(i.HELP_MARGIN);return t.replace(e,s)}return"..."};if(null!=t.helpInput){var o=new RegExp("(\n)","g".split("u").join(""));t.helpInput="~gray~\t "+t.helpInput.replace(o,"\n\t ")}if(null!=t.helpOutput){var l=new RegExp("(\n)","g".split("u").join(""));t.helpOutput="~gray~\t "+t.helpOutput.replace(l,"\n\t ")}for(var a=0,h=t.Actions;a<h.length;){var c=h[a];++a,c[2]=r(c[2])}for(var u=0,_=t.Options;u<_.length;){var d=_[u];++u,d[2]=r(d[2])}var f=this.T.sprintf(" ~green~Program Usage: ~white~ \n");process.stdout.write(f),null==e.executable&&(e.executable="app.js");var p="   "+e.executable+" ";0<t.Actions.length&&(p+="<action> "),0<t.Options.length&&(p+="-<option> <parameter> ...\n      "),"no"!=t.inputRule&&(p+="<input> ","multi"==t.inputRule&&(p+="... ")),"no"!=t.outputRule&&(p+="-o <output> ");var g=this.T;process.stdout.write(p),process.stdout.write("\n");var m=g.sprintf("~darkgray~ ~line2~");process.stdout.write(m);var v=!1;if("no"!=t.inputRule){v=!0;var w=this.T.sprintf("~yellow~ <input> ~!~");process.stdout.write(w);this.T;var b=s(t.inputRule);if(process.stdout.write(b),"multi"==t.inputRule){var y=this.T.sprintf("~darkcyan~ <multiple supported>");process.stdout.write(y)}this.T;if(process.stdout.write("\n"),null!=t.helpInput){var x=this.T,S=x.sprintf(t.helpInput);process.stdout.write(S);process.stdout.write("\n")}}if("no"!=t.outputRule){v=!0;var k=this.T.sprintf("~yellow~ <output> ~!~");process.stdout.write(k);this.T;var T=s(t.outputRule);process.stdout.write(T);if(process.stdout.write("\n"),null!=t.helpOutput){var E=this.T,A=E.sprintf(t.helpOutput);process.stdout.write(A);process.stdout.write("\n")}}if(v){var N=this.T.sprintf(" ~darkgray~~line2~");process.stdout.write(N)}this.T;if(process.stdout.write("[0m"),0<t.Actions.length){var I=this.T.sprintf(" ~magenta~<actions> ~!fg~");process.stdout.write(I);var O=this.T.sprintf("~darkmagenta~you can set one action at a time ~!~\n");process.stdout.write(O);for(var L=0,D=t.Actions;L<D.length;){var R=D[L];++L;var C=this.T.sprintf("~white~ "+R[0]+n(this.HELP_MARGIN-R[0].length)+"~magenta~"+R[1]);if(process.stdout.write(C),null!=R[3]){var F=this.T.sprintf("~darkgray~ ~ auto ext:["+R[3]+"]");process.stdout.write(F)}this.T;process.stdout.write("\n");var j=n(this.HELP_MARGIN);process.stdout.write(j);var P=this.T,B=P.sprintf("~gray~ "+R[2]+"\n");process.stdout.write(B);process.stdout.write("[0m")}}if(0<t.Options.length){var M=this.T.sprintf(" ~cyan~<options> ~!fg~");process.stdout.write(M);var G=this.T.sprintf("~darkcyan~you can set many options~!~\n");process.stdout.write(G);for(var H=0,W=t.Options;H<W.length;){var K=W[H];if(++H,"-"!=K[1].charAt(0)){var z=this.T.sprintf("~white~ "+K[0]+n(this.HELP_MARGIN-K[0].length)+"~cyan~"+K[1]);if(process.stdout.write(z),null!=K[3]){var U=this.T.sprintf("~darkgray~ [requires parameter] ");process.stdout.write(U)}this.T;process.stdout.write("\n");var Y=n(this.HELP_MARGIN);process.stdout.write(Y);var X=this.T,q=X.sprintf("~gray~ "+K[2]+"\n");process.stdout.write(q);process.stdout.write("[0m")}}}},printBanner:function(t){null==t&&(t=!1);var e=this.PROGRAM_INFO;this.T;process.stdout.write("\n");var s=this.T.sprintf("~bg_cyan~~black~==~!~~cyan~~b~ "+e.name+" ~darkgray~v"+e.version+"~!~\n");if(process.stdout.write(s),t){if(null!=e.desc){this.T;process.stdout.write(" - "+e.desc+"\n")}if(null!=e.author){this.T;process.stdout.write(" - "+e.author+" \n")}}var i=this.T.sprintf(" ~darkgray~~line~~!~");process.stdout.write(i)},exitError:function(t,e){null==e&&(e=!1);var s=this.T.sprintf("\n~bg_darkred~~white~ ERROR ~!~ ~red~"+t+"\n");if(process.stdout.write(s),e){var i=this.T.sprintf("~darkgray~ ~line2~~yellow~ -help ~!~ for usage info\n");process.stdout.write(i)}process.exit(1)},getArgOption:function(t){for(var e=0,s=this.ARGS.Options;e<s.length;){var i=s[e];if(++e,i[0]==t)return i}return null},getArgAction:function(t,e){for(var s=0,i=this.ARGS.Actions;s<i.length;){var n=i[s];if(++s,null!=t&&n[0]==t)return n;if(null!=e&&null!=n[3]&&0<=n[3].split(",").indexOf(e.toLowerCase()))return n}return null},__class__:o};var h=function(){this.size_W2=[25,5],this._tui_inited=!1,o.call(this)};h.__name__="Main",h.main=function(){new h},h.__super__=o,h.prototype=i(o.prototype,{init:function(){this.PROGRAM_INFO={name:u.NAME,version:u.VER,author:"JohnDimi"},this.ARGS.Actions=[["cfg","Config","Opens the config file with the associated OS editor"],["install","-install","Called by the NPM installer to create the config file"]],this.ARGS.Options=[["-size","Size",'Set rendering area size. "WIDTH,HEIGHT" or "full" to use the full window area\ne.g. -size 80,20 | -size full',"1"]],o.prototype.init.call(this)},onExit:function(){this._tui_inited&&this.T.move(0,B.height),o.prototype.onExit.call(this)},parseSetSize:function(t){var e=it.__cast(t,String).split(",");if(null!=e&&2==e.length){var s=j.parseInt(e[0]),i=j.parseInt(e[1]);h.WIDTH=h.WIDTH_MIN<s?s:h.WIDTH_MIN,h.HEIGHT=h.HEIGHT_MIN<i?i:h.HEIGHT_MIN}},onStart:function(){var e=this;if("install"!=this.argsAction)if("cfg"!=this.argsAction){if(this.engine=new u,!this.engine.init()){this.printBanner();var t=this.T.sprintf("\n ~red~INIT ERROR : ~!~"+this.engine.ERROR);process.stdout.write(t);var s=this.T.sprintf("\n ~yellow~Settings file : ~!~"+u.getConfigFullpath());process.stdout.write(s);var i=this.T.sprintf("\n You can also run ~yellow~psxmed cfg~!~ to open the config file");process.stdout.write(i);this.T;return process.stdout.write("\n"),void this.waitKeyQuit()}null!=this.engine.string_size&&this.parseSetSize(this.engine.string_size),null!=this.argsOptions.size&&("full"==this.argsOptions.size?(h.WIDTH=this.T.getWidth(),h.HEIGHT=this.T.getHeight()):this.parseSetSize(this.argsOptions.size)),this.T.setTitle(u.NAME),this.T.resizeTerminal(h.WIDTH,h.HEIGHT),this.T.pageDown(),this.T.clearScreen(),this.T.cursorHide(),B.create(new C,new F,h.WIDTH,h.HEIGHT,"black.1","blue.1"),B.set_TAB_behavior("WINDOW","exit"),this._tui_inited=!0,this.engine.onMednafenExit=pt(this,this.onGameExit),this.winList=new I("main",h.WIDTH-this.size_W2[0]-4-4,h.HEIGHT-7),this.winList.pos(3,3),this.winList.addStack(new W("Available Games").setColor(null,"green")),this.winList.addSeparator();var n=new U(null,this.winList.get_inWidth(),this.winList.get_inHeight()-2);n.setData(this.engine.get_list_names()),n.onSelect=pt(this,this.openOptionsForGame),n.flag_letter_jump=!0,this.winList.addStack(n),this.winList.open(!0),this.winList.listen(function(t,e){"escape"==t&&B.popupConfirm(function(){process.exit(0)},"QUIT")}),this.create_header_footer(),this.create_info();var r=P.win;this.winOptions=new I("options",20,5,null!=xt["red.1"]?r.getReserved("red.1"):r.h["red.1"]),this.winOptions.posNext(this.winList,2).move(0,2),this.winOptions.isOptionsPopup(),this.winOptions.addStack(new H("b1","Launch")),this.winOptions.addSeparator(),this.winOptBtns=[],this.engine.flag_use_ramdrive&&(this.winOptions.size(this.winOptions.width,this.winOptions.height+5),this.winOptBtns.push(this.winOptions.addStack(new H("b2","Local --\x3e RAM"))),this.winOptBtns.push(this.winOptions.addStack(new H("b3","RAM --\x3e Local"))),this.winOptBtns.push(this.winOptions.addStack(new H("b4","Delete all RAM").extra("?Delete all Saves from RAM?"))),this.winOptBtns.push(this.winOptions.addStack(new H("b5","Delete all States").extra("?Delete States from RAM + LOCAL?"))),this.winOptions.addSeparator()),this.winOptions.addStack(new H("","Close").extra("close")),this.winOptions.listen(pt(this,this.listen_Options));var o=new Y("utility",1,0);o.setPanelStyle("gray","darkgray",-1),o.setItemStyle("left",0,1,1,1,1),o.setItems(["FixCheats","About"]),o.onSelect=function(t){switch(t){case 0:e.engine.fixCheats(),e.openLogStatus(e.engine.OPLOG);break;case 1:X.create("Mednafen launcher\nCreated by JohnDimi, using Haxe",0,null,40,null,!0)}},B.A.screen(o,"right","top",1),o.open(),this.winLog=new I("winlog",o.width,1),this.winLog.padding(0,0),this.winLog.modifyStyle({text:"yellow",borderStyle:0}),this.winLog.flag_focusable=!1,this.winLog.addStack(new W("",this.winLog.get_inWidth(),"center").setSID("log")),B.A.down(this.winLog,o,0,1),0!=this.engine.list_games.length||X.create("No games found",0,function(t){process.exit(0)},40,null,!1)}else{var l=this.T.sprintf("Opening configuration file...");process.stdout.write(l);var a="start "+u.getConfigFullpath();nt.spawnSync(a,{shell:!0,stdio:"inherit"})}else{u.NPM_install();this.T;process.stdout.write("- Created empty config file OK")}},openOptionsForGame:function(t){this.engine.prepareGame(t),this.engine.flag_use_ramdrive&&(this.winOptBtns[0].set_disabled(!this.engine.anySavesLOCAL()),this.winOptBtns[1].set_disabled(!this.engine.anySavesRAM()),this.winOptBtns[2].set_disabled(this.winOptBtns[1].disabled),this.winOptBtns[3].set_disabled(this.winOptBtns[0].disabled&&this.winOptBtns[1].disabled)),this.winOptions.open(!0)},listen_Options:function(t,e){var s=this,i=function(){s.openOptionsForGame(s.engine.index),null!=s.engine.OPLOG&&s.openLogStatus(s.engine.OPLOG)};if("close"==t)this.winInfo.close(),this.winList.focus();else if("open"==t)this.openGameInfo();else if("fire"==t)switch(e.SID){case"b1":if(this.winOptions.close(),!this.engine.launchGame())return void this.openLogStatus(this.engine.ERROR);this.openGameLaunchWindow();break;case"b2":this.engine.copySave_LocalToRam(),i();break;case"b3":this.engine.copySave_RamToLocal(),i();break;case"b4":this.engine.deleteGameSaves_fromRam(),i();break;case"b5":this.engine.deleteGameStates_fromEveryWhere(),i()}},openGameLaunchWindow:function(){this.winList.close();var t="Now Playing:\n"+this.engine.get_gameName(),e=P.win;this.pop=X.create(t,3,null,40,null!=xt["gray.1"]?e.getReserved("gray.1"):e.h["gray.1"])},onGameExit:function(){null!=this.pop&&this.pop.close(),this.pop=null,this.winList.open(!0)},create_header_footer:function(){var t=new I(null,-1,1);t.flag_focusable=!1,t.modifyStyle({bg:"darkcyan",text:"black",borderStyle:0,borderColor:{fg:"darkblue"}}),t.padding(2,0),t.addStack(new W(this.PROGRAM_INFO.name+" v"+this.PROGRAM_INFO.version));var e=new I(null,-1,1);e.flag_focusable=!1,e.padding(0),e.modifyStyle({bg:"gray",text:"darkblue",borderStyle:0}),e.addStack(new W("[TAB] = FOCUS | [â†‘â†“] = MOVE | [ENTER] = SELECT | [ESC] = BACK",e.get_inWidth(),"center")),e.pos(0,B.height-e.height),B.add(t),B.add(e)},create_info:function(){var t=P.win;this.winInfo=new I(null,-1,2,null!=xt["black.1"]?t.getReserved("black.1"):t.h["black.1"]),this.winInfo.padding(2,0),this.winInfo.set_borderStyle(0),this.inf_name=new W("",this.winInfo.get_inWidth()-13),this.inf_name.setColor(null,"yellow"),this.winInfo.addStackInline([new W("Game Name : "),this.inf_name]),this.winInfo.flag_focusable=!1,B.A.down(this.winInfo,this.winList),this.inf_RAM=new H("","   ",1),this.inf_LOCAL=new H("","   ",1),this.inf_ZIP=new W("").setColor(null,"cyan"),this.winInfo.addStackInline([new W("Save on RAM"),this.inf_RAM,new W("Save Local"),this.inf_LOCAL,this.inf_ZIP])},openLogStatus:function(t){var e=this;this.winLog.getElIndex(1).set_text(t),this.winLog.open(),null!=this.winTimer&&(this.winTimer.stop(),this.winTimer=null),this.winTimer=Q.delay(function(){e.winLog.close()},h.STATUS_POPUP_TIME)},openGameInfo:function(){this.inf_name.set_text(this.engine.current.name+"     "),this.inf_name.text.length>this.inf_name.width?this.inf_name.scroll(125):this.inf_name.stop(),0<this.engine.saves_ram.length?(this.inf_RAM.set_text("YES"),this.inf_RAM.colorIdle("green")):(this.inf_RAM.set_text("NO"),this.inf_RAM.colorIdle("red")),0<this.engine.saves_local.length?(this.inf_LOCAL.set_text("YES"),this.inf_LOCAL.colorIdle("green")):(this.inf_LOCAL.set_text("NO"),this.inf_LOCAL.colorIdle("red")),this.engine.isZIP?this.inf_ZIP.set_text("(zipped)"):this.inf_ZIP.set_text(""),this.winInfo.open()},__class__:h}),Math.__name__="Math";var a=function(){};a.__name__="Reflect",a.field=function(t,e){try{return t[e]}catch(t){t instanceof st&&t.val;return null}},a.getProperty=function(t,e){var s;return null==t?null:!!t.__properties__&&(s=t.__properties__["get_"+e])?t[s]():t[e]},a.fields=function(t){var e=[];if(null!=t){var s=Object.prototype.hasOwnProperty;for(var i in t)"__id__"!=i&&"hx__closures__"!=i&&s.call(t,i)&&e.push(i)}return e},a.copy=function(t){for(var e={},s=0,i=a.fields(t);s<i.length;){var n=i[s];++s,e[n]=a.field(t,n)}return e};var j=function(){};j.__name__="Std",j.string=function(t){return it.__string_rec(t,"")},j.parseInt=function(t){var e=parseInt(t,!t||"0"!=t[0]||"x"!=t[1]&&"X"!=t[1]?10:16);return isNaN(e)?null:e},j.random=function(t){return t<=0?0:Math.floor(Math.random()*t)};var V=function(){};V.__name__="StringTools",V.isSpace=function(t,e){var s=g.cca(t,e);return 8<s&&s<14||32==s},V.ltrim=function(t){for(var e=t.length,s=0;s<e&&V.isSpace(t,s);)++s;return 0<s?g.substr(t,s,e-s):t},V.rtrim=function(t){for(var e=t.length,s=0;s<e&&V.isSpace(t,e-s-1);)++s;return 0<s?g.substr(t,0,e-s):t},V.trim=function(t){return V.ltrim(V.rtrim(t))},V.lpad=function(t,e,s){if(e.length<=0)return t;var i="";for(s-=t.length;i.length<s;)i+=null==e?"null":""+e;return i+=null==t?"null":""+t},V.rpad=function(t,e,s){if(e.length<=0)return t;var i="";for(i+=null==t?"null":""+t;i.length<s;)i+=null==e?"null":""+e;return i};var n=function(){};n.__name__="haxe.io.Output";var r=function(t){this.fd=t};r.__name__="_Sys.FileOutput",r.__super__=n,r.prototype=i(n.prototype,{writeByte:function(t){ot.writeSync(this.fd,String.fromCodePoint(t))},writeBytes:function(t,e,s){var i=t.b;return ot.writeSync(this.fd,ut.from(i.buffer,i.byteOffset,t.length),e,s)},writeString:function(t,e){ot.writeSync(this.fd,t)},flush:function(){ot.fsyncSync(this.fd)},close:function(){ot.closeSync(this.fd)},__class__:r});var l=function(){};l.__name__="haxe.io.Input";var _=function(t){this.fd=t};_.__name__="_Sys.FileInput",_.__super__=l,_.prototype=i(l.prototype,{readByte:function(){var t=new ut(1);try{ot.readSync(this.fd,t,0,1,null)}catch(t){var e=t instanceof st?t.val:t;throw"EOF"==e.code?new st(new $):new st(tt.Custom(e))}return t[0]},readBytes:function(t,e,s){var i=t.b,n=ut.from(i.buffer,i.byteOffset,t.length);try{return ot.readSync(this.fd,n,e,s,null)}catch(t){var r=t instanceof st?t.val:t;throw"EOF"==r.code?new st(new $):new st(tt.Custom(r))}},close:function(){ot.closeSync(this.fd)},__class__:_});var d=b["djNode.KeycodeID"]={__ename__:!0,__constructs__:["up","down","left","right","home","insert","delete","end","pageup","pagedown","backsp","tab","enter","space","esc","ctrlC","acute","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","other"],up:{_hx_index:0,__enum__:"djNode.KeycodeID",toString:s},down:{_hx_index:1,__enum__:"djNode.KeycodeID",toString:s},left:{_hx_index:2,__enum__:"djNode.KeycodeID",toString:s},right:{_hx_index:3,__enum__:"djNode.KeycodeID",toString:s},home:{_hx_index:4,__enum__:"djNode.KeycodeID",toString:s},insert:{_hx_index:5,__enum__:"djNode.KeycodeID",toString:s},delete:{_hx_index:6,__enum__:"djNode.KeycodeID",toString:s},end:{_hx_index:7,__enum__:"djNode.KeycodeID",toString:s},pageup:{_hx_index:8,__enum__:"djNode.KeycodeID",toString:s},pagedown:{_hx_index:9,__enum__:"djNode.KeycodeID",toString:s},backsp:{_hx_index:10,__enum__:"djNode.KeycodeID",toString:s},tab:{_hx_index:11,__enum__:"djNode.KeycodeID",toString:s},enter:{_hx_index:12,__enum__:"djNode.KeycodeID",toString:s},space:{_hx_index:13,__enum__:"djNode.KeycodeID",toString:s},esc:{_hx_index:14,__enum__:"djNode.KeycodeID",toString:s},ctrlC:{_hx_index:15,__enum__:"djNode.KeycodeID",toString:s},acute:{_hx_index:16,__enum__:"djNode.KeycodeID",toString:s},F1:{_hx_index:17,__enum__:"djNode.KeycodeID",toString:s},F2:{_hx_index:18,__enum__:"djNode.KeycodeID",toString:s},F3:{_hx_index:19,__enum__:"djNode.KeycodeID",toString:s},F4:{_hx_index:20,__enum__:"djNode.KeycodeID",toString:s},F5:{_hx_index:21,__enum__:"djNode.KeycodeID",toString:s},F6:{_hx_index:22,__enum__:"djNode.KeycodeID",toString:s},F7:{_hx_index:23,__enum__:"djNode.KeycodeID",toString:s},F8:{_hx_index:24,__enum__:"djNode.KeycodeID",toString:s},F9:{_hx_index:25,__enum__:"djNode.KeycodeID",toString:s},F10:{_hx_index:26,__enum__:"djNode.KeycodeID",toString:s},F11:{_hx_index:27,__enum__:"djNode.KeycodeID",toString:s},F12:{_hx_index:28,__enum__:"djNode.KeycodeID",toString:s},other:{_hx_index:29,__enum__:"djNode.KeycodeID",toString:s}},f=function(){};f.__name__="djNode.Keycode",f.toKeyCodeID=function(t){if(null==g.cca(t,1))switch(g.cca(t,0)){case 3:return d.ctrlC;case 8:return d.backsp;case 9:return d.tab;case 13:return d.enter;case 27:return d.esc;case 32:return d.space;case 96:return d.acute;case 127:return d.backsp}else if(27==g.cca(t,0)&&91==g.cca(t,1))switch(g.cca(t,2)){case 49:switch(g.cca(t,3)){case 55:return d.F6;case 56:return d.F7;case 57:return d.F8;case 126:return d.home}break;case 50:switch(g.cca(t,3)){case 48:return d.F9;case 49:return d.F10;case 51:return d.F11;case 52:return d.F12;case 126:return d.insert}break;case 51:return d.delete;case 52:return d.end;case 53:return d.pageup;case 54:return d.pagedown;case 65:return d.up;case 66:return d.down;case 67:return d.right;case 68:return d.left;case 91:switch(g.cca(t,3)){case 65:return d.F1;case 66:return d.F2;case 67:return d.F3;case 68:return d.F4;case 69:return d.F5}}return null};var p=function(){};p.__name__="djNode.Keyboard",p.startCapture=function(t,e){null==t&&(t=!0),p.stop(),null!=e&&(p.onData=e),p.stdin=process.stdin,p.stdin.setRawMode(t),p.stdin.setEncoding("utf8"),p.stdin.on("data",p.onKeyData),p.stdin.resume()},p.onKeyData=function(t){if(p.FLAG_CAN_BREAK&&t==f.CTRLC)return p.stop(),null!=p.onBreak&&p.onBreak(),void(p.onBreak=null);null!=p.onData&&p.onData(t)},p.stop=function(){null!=p.stdin&&(p.stdin.pause(),p.stdin.setRawMode(!1),p.stdin.removeAllListeners("data"))},p.flush=function(){null!=p.stdin&&(p.stdin.pause(),p.stdin.resume())};var m=function(){this.colormap_fg=new at;var t=this.colormap_fg,e="darkgray";null!=xt[e]?t.setReserved(e,"[90m"):t.h[e]="[90m";var s=this.colormap_fg;null!=xt.red?s.setReserved("red","[91m"):s.h.red="[91m";var i=this.colormap_fg,n="green";null!=xt[n]?i.setReserved(n,"[92m"):i.h[n]="[92m";var r=this.colormap_fg,o="yellow";null!=xt[o]?r.setReserved(o,"[93m"):r.h[o]="[93m";var l=this.colormap_fg,a="blue";null!=xt[a]?l.setReserved(a,"[94m"):l.h[a]="[94m";var h=this.colormap_fg,c="magenta";null!=xt[c]?h.setReserved(c,"[95m"):h.h[c]="[95m";var u=this.colormap_fg,_="cyan";null!=xt[_]?u.setReserved(_,"[96m"):u.h[_]="[96m";var d=this.colormap_fg,f="white";null!=xt[f]?d.setReserved(f,"[97m"):d.h[f]="[97m";var p=this.colormap_fg,g="black";null!=xt[g]?p.setReserved(g,"[30m"):p.h[g]="[30m";var m=this.colormap_fg,v="darkred";null!=xt[v]?m.setReserved(v,"[31m"):m.h[v]="[31m";var w=this.colormap_fg,b="darkgreen";null!=xt[b]?w.setReserved(b,"[32m"):w.h[b]="[32m";var y=this.colormap_fg,x="darkyellow";null!=xt[x]?y.setReserved(x,"[33m"):y.h[x]="[33m";var S=this.colormap_fg,k="darkblue";null!=xt[k]?S.setReserved(k,"[34m"):S.h[k]="[34m";var T=this.colormap_fg,E="darkmagenta";null!=xt[E]?T.setReserved(E,"[35m"):T.h[E]="[35m";var A=this.colormap_fg,N="darkcyan";null!=xt[N]?A.setReserved(N,"[36m"):A.h[N]="[36m";var I=this.colormap_fg,O="gray";null!=xt[O]?I.setReserved(O,"[37m"):I.h[O]="[37m",this.colormap_bg=new at;var L=this.colormap_bg,D="darkgray";null!=xt[D]?L.setReserved(D,"[100m"):L.h[D]="[100m";var R=this.colormap_bg;null!=xt.red?R.setReserved("red","[101m"):R.h.red="[101m";var C=this.colormap_bg,F="green";null!=xt[F]?C.setReserved(F,"[102m"):C.h[F]="[102m";var j=this.colormap_bg,P="yellow";null!=xt[P]?j.setReserved(P,"[103m"):j.h[P]="[103m";var B=this.colormap_bg,M="blue";null!=xt[M]?B.setReserved(M,"[104m"):B.h[M]="[104m";var G=this.colormap_bg,H="magenta";null!=xt[H]?G.setReserved(H,"[105m"):G.h[H]="[105m";var W=this.colormap_bg,K="cyan";null!=xt[K]?W.setReserved(K,"[106m"):W.h[K]="[106m";var z=this.colormap_bg,U="white";null!=xt[U]?z.setReserved(U,"[107m"):z.h[U]="[107m";var Y=this.colormap_bg,X="black";null!=xt[X]?Y.setReserved(X,"[40m"):Y.h[X]="[40m";var q=this.colormap_bg,V="darkred";null!=xt[V]?q.setReserved(V,"[41m"):q.h[V]="[41m";var Z=this.colormap_bg,Q="darkgreen";null!=xt[Q]?Z.setReserved(Q,"[42m"):Z.h[Q]="[42m";var J=this.colormap_bg,$="darkyellow";null!=xt[$]?J.setReserved($,"[43m"):J.h[$]="[43m";var tt=this.colormap_bg,et="darkblue";null!=xt[et]?tt.setReserved(et,"[44m"):tt.h[et]="[44m";var st=this.colormap_bg,it="darkmagenta";null!=xt[it]?st.setReserved(it,"[45m"):st.h[it]="[45m";var nt=this.colormap_bg,rt="darkcyan";null!=xt[rt]?nt.setReserved(rt,"[46m"):nt.h[rt]="[46m";var ot=this.colormap_bg,lt="gray";null!=xt[lt]?ot.setReserved(lt,"[47m"):ot.h[lt]="[47m"};m.__name__="djNode.Terminal",m.prototype={demoPrintColors:function(){process.stdout.write("Available Colors\n"),this.drawLine(),process.stdout.write("[s");for(var t=0,e=m.AVAIL_COLORS;t<e.length;){var s=e[t];++t,"black"==s?this.bg("gray"):this.bg("black");this.fg(s);process.stdout.write(s),process.stdout.write("\n");process.stdout.write("[39m")}process.stdout.write("[0m"),process.stdout.write("[u");for(var i=0,n=m.AVAIL_COLORS;i<n.length;){var r=n[i];++i,process.stdout.write("[15C"),"white"==r||"yellow"==r?this.fg("darkgray"):this.fg("white");this.bg(r);process.stdout.write(r),process.stdout.write("\n");process.stdout.write("[49m")}this.drawLine()},resizeTerminal:function(t,e){var s="mode con: cols="+t+" lines="+e;nt.spawnSync(s,{shell:!0,stdio:"inherit"})},setTitle:function(t){var e="title "+t;nt.spawnSync(e,{shell:!0,stdio:"inherit"})},getWidth:function(){return process.stdout.columns},getHeight:function(){return process.stdout.rows},print:function(t){return process.stdout.write(t),this},println:function(t){return process.stdout.write(t+"\n"),this},fg:function(t){if(null==t)return process.stdout.write("[39m"),this;var e=this.colormap_fg,s=null!=xt[t]?e.getReserved(t):e.h[t];return process.stdout.write(s),this},bg:function(t){if(null==t)return process.stdout.write("[49m"),this;var e=this.colormap_bg,s=null!=xt[t]?e.getReserved(t):e.h[t];return process.stdout.write(s),this},bold:function(){return process.stdout.write("[1m"),this},resetFg:function(){return process.stdout.write("[39m"),this},resetBg:function(){return process.stdout.write("[49m"),this},resetBold:function(){return process.stdout.write("[21m"),this},reset:function(){return process.stdout.write("[0m"),this},endl:function(){return process.stdout.write("\n"),this},up:function(t){return null==t&&(t=1),process.stdout.write("["+t+"A"),this},down:function(t){return null==t&&(t=1),process.stdout.write("["+t+"B"),this},forward:function(t){return null==t&&(t=1),process.stdout.write("["+t+"C"),this},back:function(t){return null==t&&(t=1),process.stdout.write("["+t+"D"),this},move:function(t,e){return process.stdout.cursorTo(t-1,e-1),this},moveR:function(t,e){return process.stdout.moveCursor(t,e),this},savePos:function(){return process.stdout.write("[s"),this},restorePos:function(){return process.stdout.write("[u"),this},pageDown:function(){process.stdout.write("[s");var t=V.lpad("","\n",this.getHeight()+1);return process.stdout.write(t),process.stdout.write("[u"),this},clearFromHere:function(t){process.stdout.write("[s");var e=V.lpad(""," ",t);return process.stdout.write(e),process.stdout.write("[u"),this},clearLine:function(t){return null==t&&(t=2),process.stdout.write("["+t+"K"),this},clearScreen:function(t){return null==t&&(t=2),0<t&&this.move(1,1),process.stdout.clearScreenDown(),this},drawLine:function(t,e){null==t&&(t=m.DEFAULT_LINE_SYMBOL),null==e&&(e=m.DEFAULT_LINE_WIDTH);var s=V.lpad("",t,e);return process.stdout.write(s),process.stdout.write("\n"),this},H1:function(t,e){null==e&&(e="darkmagenta");var s=this.sprintf("~black~~bg_"+e+"~ "+m.H1_SYMBOL+"~white~ "+t+" ~!~\n~line~");process.stdout.write(s)},H2:function(t,e){null==e&&(e="cyan");var s=this.sprintf(" ~bg_"+e+"~~black~"+m.H2_SYMBOL+"~!~ ~"+e+"~"+t+"~!~\n ~line2~");process.stdout.write(s)},H3:function(t,e){null==e&&(e="blue");var s=this.sprintf("~"+e+"~ "+m.H3_SYMBOL+" ~!~"+t+"\n ~line2~");process.stdout.write(s)},list:function(t,e){null==e&&(e="green");var s=this.sprintf("~"+e+"~  "+m.LIST_SYMBOL+" ~!~"+t+"\n");process.stdout.write(s)},printf:function(t){var e=this.sprintf(t);return process.stdout.write(e),this},cursorHide:function(){return process.stdout.write("[?25l"),this},cursorShow:function(){return process.stdout.write("[?25h"),this},sprintf:function(t){var r=this;return new c("~(\\S[^~]*)~","g").map(t,function(t){var e=t.matched(1);switch(e){case"!":return"[0m";case"!b":return"[21m";case"!bg":return"[49m";case"!fg":return"[39m";case"b":return"[1m";case"line":return V.lpad("",m.DEFAULT_LINE_SYMBOL,m.DEFAULT_LINE_WIDTH)+"\n";case"line2":return V.lpad("",m.DEFAULT_LINE_SYMBOL,Math.ceil(m.DEFAULT_LINE_WIDTH/2))+"\n";default:try{if("bg_"==g.substr(e,0,3)){var s=g.substr(e,3,null),i=r.colormap_bg;return null!=xt[s]?i.getReserved(s):i.h[s]}var n=r.colormap_fg;return null!=xt[e]?n.getReserved(e):n.h[e]}catch(t){t instanceof st&&t.val;return""}}})},__class__:m};var v=function(){};v.__name__="djNode.tools.FileTool",v.createRecursiveDir=function(t){var e=ht.normalize(t).split(ht.sep),s=e.length;if(s<=0)throw new st("Path is empty!");var i=0,n="";if(0<e[0].indexOf(":")){try{ot.statSync(e[0])}catch(t){var r=t instanceof st?t.val:t;if(r instanceof Error){throw new st("Drive "+e[0]+" does not exist!!")}throw t}i=1,n=e[0]+ht.sep}for(;i<s;)n=ht.join(n,e[i]),0==v.pathExists(n)&&ot.mkdirSync(n),++i},v.deleteRecursiveDir=function(t){if(v.pathExists(t)){for(var e=ot.readdirSync(t),s=0;s<e.length;){var i=e[s];++s;var n=ht.join(t,i);ot.lstatSync(n).isDirectory()?v.deleteRecursiveDir(n):ot.unlinkSync(n)}ot.rmdirSync(t)}},v.hasWriteAccess=function(t){try{ot.accessSync(t,2)}catch(t){var e=t instanceof st?t.val:t;if(e instanceof Error){return!1}throw t}return!0},v.pathExists=function(t){try{ot.statSync(t)}catch(t){var e=t instanceof st?t.val:t;if(e instanceof Error){return!1}throw t}return!0},v.moveFile=function(e,s){try{ot.renameSync(e,s)}catch(t){var i=t instanceof st?t.val:t;if(!(i instanceof Error))throw t;v.copyFile(e,s);try{ot.unlinkSync(e)}catch(t){var n=t instanceof st?t.val:t;if(!(n instanceof Error))throw t;w.log('Could not delete "'+e+'" while moving.',3,{fileName:"djNode/tools/FileTool.hx",lineNumber:155,className:"djNode.tools.FileTool",methodName:"moveFile"})}}},v.copyFile=function(t,e){ot.writeFileSync(e,ot.readFileSync(t))},v.getFileListFromDir=function(t,e){null==e&&(e=!1);for(var s=ot.readdirSync(ht.normalize(t)),i=[],n=0;n<s.length;){var r=s[n];++n,ot.statSync(ht.join(t,r)).isFile()&&(e?i.push(ht.join(t,r)):i.push(r))}return i},v.getFileListFromDirR=function(t,l){var a=[],h=null;return(h=function(t){for(var e=ot.readdirSync(ht.normalize(t)),s=0;s<e.length;){var i=e[s];++s;var n=ht.join(t,i);try{if(ot.statSync(n).isDirectory())h(n);else if(null!=l){var r=v.getFileExt(i);-1<l.indexOf(r)&&a.push(n)}else a.push(n)}catch(t){var o=t instanceof st?t.val:t;if(o instanceof Error){return}throw t}}})(t),a},v.getFileListFromWildcard=function(t){var e,s=[],i=ht.dirname(t),n=v.getFileExt(t).toLowerCase(),r=new c("(\\S*)\\.","");if(r.match(ht.basename(t))){if(1<(e=r.matched(1)).length&&0<e.indexOf("*"))throw new st("Advanced search is currently unsupported, use basic [*.*] or [*.ext]")}else e="*";for(var o,l=ot.readdirSync(ht.normalize(i)),a=0;a<l.length;){var h=l[a];++a;try{o=ot.statSync(ht.join(i,h))}catch(t){t instanceof st&&t.val;continue}if(o.isFile()){if("*"!=e){if(!r.match(h))continue;if(e!=r.matched(1))continue}if("*"==n){s.push(ht.join(i,h));continue}if(n==g.substr(ht.extname(h),1,null).toLowerCase()){s.push(ht.join(i,h));continue}}}return s},v.getFileMD5=function(t){var e=ot.openSync(t,"r"),s=rt.createHash("md5"),i=ut.alloc(8192);try{for(var n=0;n=ot.readSync(e,i,0,8192,null),s.update(i.slice(0,n)),8192==n;);}catch(t){var r=t instanceof st?t.val:t;if(r instanceof Error){return ot.closeSync(e),null}throw t}return ot.closeSync(e),s.digest("hex")},v.getFileExt=function(t){return g.substr(ht.extname(t),1,null).toLowerCase()},v.getPathNoExt=function(t){return ht.join(ht.parse(t).dir,ht.parse(t).name)};var w=function(){};w.__name__="djNode.tools.LOG",w.init=function(t,e){null==e&&(e=!1),w._isInited||(w._isInited=!0,w.messages=[],w.messageTypes=["DEBUG","INFO","WARN","ERROR","FATAL"],null!=t&&w.setLogFile(t,e))},w.getLog=function(){return w.messages},w.end=function(){if(null!=w.logFile&&0==w.flag_realtime_file)for(var t=0,e=w.messages;t<e.length;){var s=e[t];++t,w.push_File(s)}w.flag_socket_log&&w.io.close()},w.pipeTrace=function(){Z.trace=function(t,e){if(w.log(t,1,e),null!=e&&null!=e.customParams)for(var s=0,i=e.customParams;s<i.length;){var n=i[s];++s,w.log(n,1,e)}}},w.log=function(t,e,s){if(null==e&&(e=1),!(e<w.logLevel)){var i={pos:s,log:j.string(t),level:e};w.flag_keep_in_memory&&(w.messages.length==w.param_memory_buffer&&w.messages.shift(),w.messages.push(i)),w.flag_socket_log&&w.io.sockets.emit("logText",{data:i.log,pos:i.pos,level:i.level}),w.flag_realtime_file&&null!=w.logFile&&w.push_File(i),null!=w.onLog&&w.onLog(i)}},w.logObj=function(t,e,s){null==e&&(e=1),e<w.logLevel||(w.flag_socket_log&&w.io.sockets.emit("logObj",{data:t,pos:s,level:e}),w.flag_realtime_file&&null!=w.logFile&&w.push_File({level:e,pos:s,log:"(object): "+j.string(t)}),null!=w.onLog&&w.onLog({pos:s,level:e,log:"(object): "+j.string(t)}))},w.setSocketLogging=function(t){null==t&&(t=80),null==w.io&&(w.flag_socket_log=!0,w.io=require("socket.io").listen(t),w.log("Socket, Listening to port "+t,null,{fileName:"djNode/tools/LOG.hx",lineNumber:201,className:"djNode.tools.LOG",methodName:"setSocketLogging"}),w.io.sockets.on("connection",function(t){if(w.log("Socket, Connected to client",null,{fileName:"djNode/tools/LOG.hx",lineNumber:204,className:"djNode.tools.LOG",methodName:"setSocketLogging"}),t.on("disconnect",function(){w.log("Socket, Disconnected from client",null,{fileName:"djNode/tools/LOG.hx",lineNumber:207,className:"djNode.tools.LOG",methodName:"setSocketLogging"})}),t.emit("maxLines",w.param_memory_buffer),0<w.messages.length)for(var e=0,s=w.messages;e<s.length;){var i=s[e];++e,w.io.sockets.emit("logText",{data:i.log,pos:i.pos,level:i.level})}}))},w.push_SocketText=function(t){w.io.sockets.emit("logText",{data:t.log,pos:t.pos,level:t.level})},w.push_SocketObj=function(t,e,s){null==e&&(e=0),w.io.sockets.emit("logObj",{data:t,pos:s,level:e})},w.push_File=function(t){var e=w.messageTypes[t.level]+" ("+t.pos.fileName+":"+t.pos.lineNumber+") "+t.log+"\n";ot.appendFileSync(w.logFile,e,"utf8")},w.setLogFile=function(t,e){null==e&&(e=!1),w.logFile=t,w.flag_realtime_file=e;try{var s=" - LOG -\n -------\n - "+w.logFile+"\n - Created: "+g.dateStr(new Date)+"\n - App: "+ht.basename(process.argv[1])+"\n ---------------------------------------------------\n\n";ot.writeFileSync(w.logFile,s,"utf8")}catch(t){t instanceof st&&t.val;w.log("Could not create logfile - "+w.logFile,3,{fileName:"djNode/tools/LOG.hx",lineNumber:277,className:"djNode.tools.LOG",methodName:"setLogFile"}),w.logFile=null}if(w.flag_realtime_file&&0<w.messages.length&&null!=w.logFile)for(var i=0,n=w.messages;i<n.length;){var r=n[i];++i,w.push_File(r)}},w.timeStart=function(){w._t=(new Date).getTime()},w.timeGet=function(){return(new Date).getTime()-w._t|0};var y=function(t){this.events=new ct,this.exePath=t};y.__name__="djNode.utils.CLIApp",y.quickExec=function(t,i){nt.exec(t,function(t,e,s){i(null==t,e,s)})},y.checkRun=function(t){try{nt.execSync(t,{timeout:1e4,stdio:"ignore"});return!0}catch(t){t instanceof st&&t.val;return!1}},y.checkLinuxPackage=function(t){return!1},y.prototype={start:function(t,e){var s=this;w.log("Start Process `"+this.exePath+"` with arguments : "+t.join(" "),null,{fileName:"djNode/utils/CLIApp.hx",lineNumber:65,className:"djNode.utils.CLIApp",methodName:"start"}),this.proc=nt.spawn(this.exePath,t),this.proc.once("error",function(t){s.events.emit("close",!1,t.message)}),this.proc.once("close",function(t,e){0!=t||null!=e?(w.log("Process `"+s.exePath+"` End - [ ERROR ] `{"+e+"}`",3,{fileName:"djNode/utils/CLIApp.hx",lineNumber:93,className:"djNode.utils.CLIApp",methodName:"start"}),s.events.emit("close",!1,e)):(w.log("Process `"+s.exePath+"` End - [ OK ]",null,{fileName:"djNode/utils/CLIApp.hx",lineNumber:96,className:"djNode.utils.CLIApp",methodName:"start"}),s.events.emit("close",!0))}),null!=this.onStdErr&&(this.proc.stderr.setEncoding("utf8"),this.proc.stderr.on("data",this.onStdErr)),null!=this.onStdOut&&(this.proc.stdout.setEncoding("utf8"),this.proc.stdout.on("data",this.onStdOut))},kill:function(){null!=this.proc&&(this.proc.removeAllListeners(),this.proc.kill(),this.proc=null)},__class__:y};var x=function(){};x.__name__="djNode.utils.ProcUtil",x.getTaskPIDs=function(t){var e=[];try{for(var s=nt.execSync("tasklist").toString().split("\n"),i=new c("(\\S+)\\s*(\\d+)","ig"),n=0;n<s.length;){var r=s[n];++n,i.match(r)&&i.matched(1).toLowerCase()==t.toLowerCase()&&e.push(i.matched(2))}}catch(t){t instanceof st&&t.val}return e},x.killPID=function(t,e,s,i){null==i&&(i=!1),null==s&&(s=!1);var n="TASKKILL ";null!=t&&(e=[t]);for(var r=0;r<e.length;){var o=e[r];++r,n+="/PID "+o+" "}s&&(t+="/F "),i&&(t+="/T "),nt.execSync(n)},x.killTask=function(t,e){null==e&&(e=!1);try{var s="TASKKILL "+t;e&&(s+=" /F"),nt.execSync(s)}catch(t){t instanceof st&&t.val}};var S=function(){this.g=null};S.__name__="djTui.Align",S.prototype={screen:function(t,e,s,i){null==i&&(i=0),null==s&&(s="center"),null==e&&(e="center");var n=0,r=0;switch(e){case"center":n=B.width/2-t.width/2|0;break;case"left":n=i;break;case"right":n=B.width-t.width-i}switch(s){case"bottom":r=B.height-t.height-i;break;case"center":r=B.height/2-t.height/2|0;break;case"top":r=i}return t.pos(n,r),t},up:function(t,e,s,i){return null==i&&(i=0),null==s&&(s=0),t.move(e.x+s,e.y-t.height+i),t},down:function(t,e,s,i){return null==i&&(i=0),null==s&&(s=0),t.move(e.x+s,e.y+e.height+i),t},left:function(t,e,s,i){return null==i&&(i=0),null==s&&(s=0),t.move(e.x-t.width+s,e.y+i),t},right:function(t,e,s,i){return null==i&&(i=0),null==s&&(s=0),t.move(e.x+e.width+s,e.y+i),t},inLine:function(i,t,e,n,s){var r;null==s&&(s=0),null==n&&(n=0),null==e&&(e="center");var o=function(){for(var t=0,e=0;e<i.length;){var s=i[e];++e,t+=s.width}return t+=(i.length-1)*n};switch(e){case"center":r=s+(B.width/2-o()/2|0);break;case"left":r=s;break;case"right":r=s+B.width-o();break;default:throw new st("Not supported align type `"+e+"` Typo?")}for(var l=0;l<i.length;){var a=i[l];++l,a.pos(r,t),r+=a.width+n}},__class__:S};var k=function(t){this.flag_lock_focus=!1,this.flag_focusable=!0,this.lockDraw=!1,this.parent=null,this.isFocused=!1,this.height=0,this.width=0,this.y=0,this.x=0,this.UID=k.UID_GEN++,this.SID=t,this.callbacks=[],this.set_visible(!1),null!=this.SID&&""!=this.SID||(this.SID="id_"+this.UID)};k.__name__="djTui.BaseElement",k.focusNext=function(t,e,s){if(null==s&&(s=!0),0==t.length)return!1;for(var i=t.indexOf(e),n=i;;){if(++n>=t.length){if(-1==i)return!1;if(!s)return!1;n=0}if(n==i)return!1;if(t[n].flag_focusable&&t[n].visible)break}return t[n].focus(),!0},k.focusPrev=function(t,e,s){if(null==s&&(s=!0),0==t.length)return!1;var i=t.indexOf(e),n=i;for(-1==i&&(n=t.length);;){if(--n<0){if(-1==i)return!1;if(!s)return!1;n=t.length-1}if(n==i)return!1;if(t[n].flag_focusable&&t[n].visible)break}return t[n].focus(),!0},k.prototype={move:function(t,e){return this.x+=t,this.y+=e,this},pos:function(t,e){return this.move(t-this.x,e-this.y),this},posNext:function(t,e){return null==e&&(e=0),this.pos(t.x+t.width+e,t.y),this},setColor:function(t,e,s){return this.colorBG=null!=t?(this.colorFG=t.fg,t.bg):(this.colorFG=e,s),null==this.colorBG&&null!=this.parent&&(this.colorBG=this.parent.colorBG),this},size:function(t,e){return this.width=t,this.height=e,this},focus:function(){!this.isFocused&&this.flag_focusable&&(this.isFocused=!0,this.focusSetup(this.isFocused),this.callback("focus"),this.draw())},unfocus:function(){this.isFocused&&(this.isFocused=!1,this.focusSetup(this.isFocused),this.callback("unfocus"),this.draw())},listen:function(t){this.callbacks.push(t)},callback:function(t,e){null==e&&(e=this);for(var s=0,i=this.callbacks;s<i.length;){var n=i[s];++s,n(t,e)}},onAdded:function(){},onKey:function(t){},focusSetup:function(t){},draw:function(){},clear:function(){this.lockDraw||(B.T.reset().bg(this.parent.colorBG),B.D.rect(this.x,this.y,this.width,this.height))},overlapsWith:function(t){return this.x+this.width>t.x&&this.x<t.x+t.width&&this.y+this.height>t.y&&this.y<t.y+t.height},_readyCol:function(){B.T.reset().fg(this.colorFG).bg(this.colorBG)},set_visible:function(t){return this.visible=t},toString:function(){return it.getClass(this).__name__+": SID:"+this.SID+", UID:"+this.UID+", pos("+this.x+","+this.y+"), size("+this.width+","+this.height+")"},setData:function(t){},getData:function(){return null},reset:function(){},__class__:k,__properties__:{set_visible:"set_visible"}};var T=function(){};T.__name__="djTui.Draw",T.prototype={rect:function(t,e,s,i,n){null==n&&(n=" ");for(var r=V.lpad("",n,s),o=e,l=e+i;o<l;){var a=o++;B.T.move(t,a).print(r)}},border:function(t,e,s,i,n){null==n&&(n=1);var r=P.border[n];this.lineH(t+1,e,s-2,r.charAt(1)),this.lineV(t,e+1,i-2,r.charAt(6)),this.lineV(t+s-1,e+1,i-2,r.charAt(7)),this.lineH(t+1,e+i-1,s-2,r.charAt(4)),B.T.move(t,e).print(r.charAt(0)).moveR(s-2,0).print(r.charAt(2)),B.T.move(t,e+i-1).print(r.charAt(3)).moveR(s-2,0).print(r.charAt(5))},drawArray:function(t,e,s){for(var i=0,n=t.length;i<n;){var r=i++;B.T.move(e,s+r).print(t[r])}},lineH:function(t,e,s,i){null==i&&(i="-"),B.T.move(t,e).print(V.lpad("",i,s))},lineV:function(t,e,s,i){null==i&&(i="|"),B.T.move(t,e);for(var n=0;n<s;)B.T.move(t,e+n++).print(i)},drawGrid:function(t,e,s,i,n,r){var o=0,l=0,a=[],h=[];if(null!=s)for(var c=0,u=s.length;c<u;){var _=c++;a[_]=s[_].split("|").map(function(t){return j.parseInt(t)}),h[_]=a[_].pop()}if(null!=i)for(var d=0,f=i.length;d<f;){var p=d++;a[p]=i[p],h[p]=a[p].pop()}for(var g=0,m=a[0];g<m.length;){var v=m[g];++g,o+=v}for(var w=0;w<h.length;){var b=h[w];++w,l+=b}0<r&&this.border(t,e,o,l,r);for(var y=e,x=0,S=h.length;x<S;){var k=x++,T=h[k]-1;0==k&&--T,k!=h.length-1&&(this.lineH(t+1,y+T+1,o-2,P.border[n].charAt(1)),B.T.move(t,y+T+1).print(P.connectBorder(n,r,2)),B.T.moveR(o-2,0).print(P.connectBorder(n,r,3)));for(var E=t,A=0,N=a[k].length;A<N;){var I=A++,O=a[k][I]-1;if(0==I&&--O,E+=O+1,a[k][I]=E,I!=a[k].length-1){this.lineV(E,y+1,T,P.border[n].charAt(7));var L=null,D=null;if(0==k)L=P.connectBorder(n,r,0);else{for(var R=0,C=a[k-1];R<C.length;){var F=C[R];++R,F==E&&(L=P.connectBorder(n,n,4))}null==L&&(L=P.connectBorder(n,n,0))}D=k==h.length-1?P.connectBorder(n,r,1):P.connectBorder(n,n,1),B.T.move(E,y).print(L),B.T.move(E,y+T+1).print(D)}}y+=T+1}},__class__:T};var E=b["djTui.ElementType"]={__ename__:!0,__constructs__:["button","label","option","number","textbox","vlist","toggle","input","window"],button:{_hx_index:0,__enum__:"djTui.ElementType",toString:s},label:{_hx_index:1,__enum__:"djTui.ElementType",toString:s},option:{_hx_index:2,__enum__:"djTui.ElementType",toString:s},number:{_hx_index:3,__enum__:"djTui.ElementType",toString:s},textbox:{_hx_index:4,__enum__:"djTui.ElementType",toString:s},vlist:{_hx_index:5,__enum__:"djTui.ElementType",toString:s},toggle:{_hx_index:6,__enum__:"djTui.ElementType",toString:s},input:{_hx_index:7,__enum__:"djTui.ElementType",toString:s},window:{_hx_index:8,__enum__:"djTui.ElementType",toString:s}},A=function(){};A.__name__="djTui.StrTool",A.bytesToMBStr=function(t){return j.string(Math.ceil(t/1048576))},A.padString=function(t,e,s){null==s&&(s="left");var i=e-t.length;if(0==i)return t;if(i<0)return t.substring(0,e-1)+"~";switch(s){case"center":var n=Math.ceil(i/2),r=Math.floor(i/2);t=V.rpad(""," ",n)+t+V.rpad(""," ",r);break;case"left":t=V.rpad(t," ",e);break;case"right":t=V.lpad(t," ",e)}return t},A.splitToLines=function(t,e){var s=new RegExp("(\n)","g".split("u").join(""));t=t.replace(s," #nl# ");for(var i=new RegExp("(\\s|\t)","g".split("u").join("")),n=(t=t.replace(i," ")).split(" "),r=[],o=0,l=n.length,a=0,h="",c=0,u=function(t){r.push(t),a=0,h=""};;){if("#nl#"==n[o]){if(u(h),++o<l)continue;break}if((c=n[o].length)+a<e?(h+=n[o]+" ",a+=c+1):e<c+a?0<a?(r.push(h),h=n[o]+" ",a=c+1):u(h=n[o].substring(0,e-1)+"~"):u(h+n[o]),!(++o<l))break}return 0<a&&u(h),r},A.repeatStr=function(t,e){return V.lpad("",e,t)},A.empty=function(t){return V.lpad(""," ",t)},A.loopString=function(t,e,s){for(var i="",n=0;n<e;)i+=t.charAt((n+s)%t.length),++n;return i};var P=function(){};P.__name__="djTui.Styles",P.init=function(){P.arrowsLR=["<>","â—„â–º","â†â†’","Â«Â»"],P.border=["        ","â”Œâ”€â”â””â”€â”˜â”‚â”‚","â•”â•â•—â•šâ•â•â•‘â•‘","â•“â”€â•–â•™â”€â•œâ•‘â•‘","â•’â•â••â•˜â•â•›â”‚â”‚","/-\\\\=/||","â–ˆâ–€â–ˆâ–ˆâ–„â–ˆâ–Œâ–"],P.bCon=["","â”¬â”´â”œâ”¤â”¼","â•¦â•©â• â•£â•¬","â•¤â•§â•Ÿâ•¢â•ª","â•¥â•¨â•žâ•¡â•«","--||T","â–ˆâ–„â–Œâ–â–ˆ"],P.win=new at;var t=P.win,e=P.createWinStyle("yellow","magenta","white","blue","darkblue"),s=t;null!=xt["blue.1"]?s.setReserved("blue.1",e):s.h["blue.1"]=e;var i=P.win,n=P.createWinStyle("yellow","red","white","darkgreen","darkgray"),r=i;null!=xt["green.1"]?r.setReserved("green.1",n):r.h["green.1"]=n;var o=P.win,l=P.createWinStyle("yellow","magenta","white","red","darkred"),a=o;null!=xt["red.1"]?a.setReserved("red.1",l):a.h["red.1"]=l;var h=P.win,c=P.createWinStyle("black","cyan","black","magenta","darkcyan"),u=h;null!=xt["magenta.1"]?u.setReserved("magenta.1",c):u.h["magenta.1"]=c;var _=P.win,d=P.createWinStyle("yellow","red","white","black","gray"),f=_;null!=xt["black.1"]?f.setReserved("black.1",d):f.h["black.1"]=d;var p=P.win,g=P.createWinStyle("black","magenta","black","cyan","gray"),m=p;null!=xt["cyan.1"]?m.setReserved("cyan.1",g):m.h["cyan.1"]=g;var v=P.win,w=P.createWinStyle("white","blue","black","gray","darkgray"),b=v;null!=xt["gray.1"]?b.setReserved("gray.1",w):b.h["gray.1"]=w},P.connectBorder=function(t,e,s){return 1==t&&2==e?P.bCon[3].charAt(s):2==t&&1==e?P.bCon[4].charAt(s):P.bCon[t].charAt(s)},P.createWinStyle=function(t,e,s,i,n,r){return null==r&&(r=1),{bg:i,text:s,titleColor:{fg:t},borderStyle:r,borderColor:{fg:s},elem_focus:{fg:e,bg:t},elem_idle:{fg:s},elem_disable_f:{fg:i,bg:n},elem_disable_i:{fg:n},scrollbar_idle:{fg:s},scrollbar_focus:{fg:t,bg:e},textbox:{fg:s},vlist_cursor:{fg:i,bg:t}}};var N=function(){};N.__name__="djTui.Tools",N.copyFields=function(t,e){if(null==t)return e;if(null==e)e=a.copy(t);else for(var s=0,i=a.fields(t);s<i.length;){var n=i[s];++s,null!=a.field(t,n)&&(e[n]=a.field(t,n))}return e},N.isEmpty=function(t){return null==t||0==t.length},N.randAr=function(t){return t[j.random(t.length)]};var B=function(){};B.__name__="djTui.WM",B.__properties__={set_backgroundColor:"set_backgroundColor"},B.create=function(t,e,s,i,n,r){null==i&&(i=0),null==s&&(s=0),B.width=s,B.height=i,B.I=t,B.T=e,B.D=new T,B.DB=new at,B.A=new S,B.STATE=new L,B.width<=0&&(B.width=B.T.MAX_WIDTH),B.height<=0&&(B.height=B.T.MAX_HEIGHT),P.init(),null==n&&(n="blue.1"),null==r&&(r="red.1");var o=P.win;B.global_style_win=a.copy(null!=xt[n]?o.getReserved(n):o.h[n]);var l=P.win;B.global_style_pop=a.copy(null!=xt[r]?l.getReserved(r):l.h[r]),B.I.onKey=B._onKey,B.I.start(),B.closeAll(),B.set_TAB_behavior(),B._isInited=!0},B.set_backgroundColor=function(t){if(t==B.backgroundColor)return t;B.backgroundColor=t,B.clearBG();for(var e=0,s=B.win_list;e<s.length;){var i=s[e];++e,i.draw()}return t},B.closeAll=function(){B.win_list=[],B.active=B.active_last=null;for(var t=0,e=B.win_list;t<e.length;){var s=e[t];++t,s.set_visible(!1)}B.clearBG(),B.STATE.current=null},B.clearBG=function(){B.T.reset(),B.T.bg(B.backgroundColor),B.D.rect(0,0,B.width,B.height)},B.add=function(t,e){null==e&&(e=!1),t.x<0?t.pos(0,t.y):t.x+t.width>B.width&&t.pos(B.width-t.width,t.y),t.y<0?t.pos(t.x,0):t.y+t.height>B.height&&t.pos(t.x,B.height-t.height),-1==B.win_list.indexOf(t)&&(B.win_list.push(t),t.callback_wm=B.onWindowCallbacks),t.set_visible(!0),t.draw(),e&&t.flag_focusable&&t.focus()},B.addTiled=function(t,e){var s=0;null!=e&&(s=e.y+e.height),B.A.inLine(t,s);for(var i=0;i<t.length;){var n=t[i];++i,B.add(n)}},B.set_TAB_behavior=function(t,e){if(null==e&&(e=""),null==t&&(t="WINDOW"),B._TAB_TYPE=e,B._TAB_LEVEL=["NONE","WM","WINDOW"].indexOf(t),B._TAB_LEVEL<0)throw new st("set_TAB_behavior invalid level ID")},B.popupConfirm=function(e,t,s){var i=new X(t,2,function(t){0==t&&e()});return i.flag_close_on_esc=!0,null==s?B.A.screen(i):i.pos(s[0],s[1]),null!=B.active?B.active.openSub(i,!0):i.openAnimated(),i},B.clearDB=function(){B.DB=new at},B.focusNext=function(){k.focusNext(B.win_list,B.active)},B.closeWindow=function(t){g.remove(B.win_list,t),B.T.reset(),B.T.bg(B.backgroundColor),B.D.rect(t.x,t.y,t.width,t.height);for(var e=0,s=B.win_list;e<s.length;){var i=s[e];++e,i.overlapsWith(t)&&i.draw()}B.active==t&&(B.active=null)!=B.active_last&&1==B.active_last.visible&&B.active_last.focus()},B.windowOverlapsWithAny=function(t){for(var e=0,s=B.win_list;e<s.length;){var i=s[e];if(++e,t!=i&&t.overlapsWith(i))return!0}return!1},B._onKey=function(t){if("esc"==t)if(null!=B.active&&B.active.flag_close_on_esc)B.active.close();else{if(B.STATE.handleESC())return;B.active.onKey("esc")}else if(1==B._TAB_LEVEL&&"tab"==t){if(null!=B.active&&B.active.flag_lock_focus)return void B.active.onKey("tab");null!=B.active&&"keep"==B._TAB_TYPE&&(B.active.flag_return_focus_once=!0),B.focusNext()}else null!=B.active&&B.active.onKey(t);null!=B.onKey&&B.onKey(t)},B.onWindowCallbacks=function(t,e){switch(t){case"close":B.closeWindow(e);break;case"focus":if(B.active==e)return;null!=B.active&&B.active.unfocus(),B.active_last=B.active,B.active=e,B.windowOverlapsWithAny(e)&&e.draw();break;case"focus_next":k.focusNext(B.win_list,B.active)||e.focusNext(!0)}};var I=function(t,e,s,i){if(null==s&&(s=5),null==e&&(e=5),this.flag_return_focus_once=!1,this.flag_enter_goto_next=!1,this.flag_close_on_bksp=!1,this.flag_close_on_esc=!1,this.rPadY=0,this.rPadX=0,this.padY=0,this.padX=0,this.display_list=[],null!=t){var n=B.DB;if(!(null!=xt[t]?n.existsReserved(t):n.h.hasOwnProperty(t))){var r=B.DB;null!=xt[t]?r.setReserved(t,this):r.h[t]=this}}k.call(this,t),this.type=E.window,this.border_el=new G,this.addChild(this.border_el),null!=i?this.set_style(a.copy(i)):this.set_style(a.copy(B.global_style_win)),this.size(e,s)};I.__name__="djTui.Window",I.__super__=k,I.prototype=i(k.prototype,{modifyStyle:function(t){var e=a.copy(this.style);N.copyFields(t,e),this.set_style(e);for(var s=0,i=this.display_list;s<i.length;){var n=i[s];++s,n.focusSetup(n.isFocused)}},getEl:function(t){for(var e=0,s=this.display_list;e<s.length;){var i=s[e];if(++e,i.SID==t)return i}return null},getElIndex:function(t){return this.display_list.length>t?this.display_list[t]:null},move:function(t,e){this.x+=t,this.y+=e;for(var s=0,i=this.display_list;s<i.length;){var n=i[s];++s,n.move(t,e)}return this.visible&&this.draw(),this},size:function(t,e){return t<0&&(t=Math.floor(B.width/-t)),e<0&&(e=Math.floor(B.height/-e)),k.prototype.size.call(this,t,e),this.border_el.size(t,e),this},padding:function(t,e){return null==e&&(e=-1),-1==e&&(e=t),this.rPadX=t,this.rPadY=e,this.padX=t,this.padY=e,0<this.borderStyle&&(this.padX++,this.padY++),this},addChild:function(t){return this.display_list.push(t),t.listen(pt(this,this.onElementCallback)),t.parent=this,t.onAdded(),t.set_visible(this.visible),t.flag_focusable&&t.focusSetup(this.isFocused),this.visible&&!this.lockDraw&&t.draw(),t},removeChild:function(t){g.remove(this.display_list,t)&&(t.set_visible(!1),this.visible&&!this.lockDraw&&this.draw())},addStack:function(t,e,s){switch(null==s&&(s="left"),null==e&&(e=0),s){case"center":t.x=this.x+(this.width/2-t.width/2|0);break;case"left":t.x=this.x+this.padX;break;case"right":t.x=this.x+this.width-t.width}return null==this.lastAdded?t.y=this.y+this.padY+e:t.y=this.lastAdded.y+this.lastAdded.height+e,this.addChild(t),this.lastAdded=t},addStackInline:function(t,e,s,i){null==i&&(i="left"),null==s&&(s=1),null==e&&(e=0);var n=0;n=null==this.lastAdded?this.y+this.padY:this.lastAdded.y+this.lastAdded.height+e;for(var r=0,o=0;o<t.length;){var l=t[o];++o,r+=l.width}r+=(t.length-1)*s;var a=0;a="center"==i?this.x+(this.width/2-r/2|0):this.x+this.padX;for(var h=0,c=t.length;h<c;){var u=h++;t[u].pos(a,n),a=t[u].x+t[u].width+s,this.addChild(t[u]),t[u].type==E.button&&(it.__cast(t[u],H).flag_leftright_escape=!0)}this.lastAdded=t[t.length-1]},isOptionsPopup:function(){this.flag_close_on_esc=!0,this.flag_close_on_bksp=!0,this.flag_lock_focus=!0},addSeparator:function(t){null==t&&(t=0),0==t&&(t=this.borderStyle);var e=V.lpad("",P.border[t].charAt(1),this.get_inWidth()),s=new W(e,0,"center");this.addStack(s)},close:function(){0!=this.visible&&(this.set_visible(!1),this.unfocus(),this.callback_wm("close",this),this.callback("close"))},open:function(t){null==t&&(t=!1),B.add(this,t),this.callback("open")},openAnimated:function(){var n=this;null!=B.active&&B.active.unfocus();var r=[.3,.6],o=new Q(I.windowAnimationTick),l=0;o.run=function(){var t=Math.ceil(r[l]*n.width),e=Math.ceil(r[l]*n.height),s=Math.ceil(n.x+(n.width-t)/2),i=Math.ceil(n.y+(n.height-e)/2);B.T.reset().fg(n.colorFG).bg(n.colorBG),B.D.rect(s,i,t,e),0<n.borderStyle&&B.D.border(s,i,t,e,n.borderStyle),(l+=1)==r.length&&(o.stop(),n.open(!0))}},openSub:function(t,e){null==e&&(e=!1),this.flag_return_focus_once=!0,e?t.openAnimated():t.open(!0)},focus:function(){if(this.flag_focusable&&(null!=this.style.borderColor_focus&&(this.border_el.setColor(this.style.borderColor_focus),this.border_el.draw()),null!=this.style.titleColor_focus&&null!=this.title_el&&(this.title_el.setColor(this.style.titleColor_focus),this.title_el.draw()),this.callback_wm("focus",this),this.lockDraw=!0,k.prototype.focus.call(this),this.lockDraw=!1,0!=this.display_list.length))if(null==this.hack_always_focus_this)this.flag_return_focus_once&&null!=this.active_last?(this.active_last.focus(),this.flag_return_focus_once=!1):k.focusNext(this.display_list,null);else{var t=this.getEl(this.hack_always_focus_this);null!=t&&t.focus()}},unfocus:function(){this.isFocused&&(null!=this.style.borderColor_focus&&(this.border_el.setColor(this.style.borderColor),this.border_el.draw()),null!=this.style.titleColor_focus&&null!=this.title_el&&(this.title_el.setColor(this.style.titleColor),this.title_el.draw()),null!=this.active&&this.active.unfocus(),this.active_last=this.active,this.active=null,this.lockDraw=!0,k.prototype.unfocus.call(this),this.lockDraw=!1)},draw:function(){if(!this.lockDraw&&this.visible){B.T.reset().fg(this.colorFG).bg(this.colorBG),B.D.rect(this.x,this.y,this.width,this.height);for(var t=0,e=this.display_list;t<e.length;){var s=e[t];++t,s.lockDraw||s.draw()}}},getActiveIndex:function(){if(null!=this.active)for(var t=0,e=this.display_list.length;t<e;){var s=t++;if(this.display_list[s]==this.active)return s}return-1},focusNext:function(t){return null==t&&(t=!1),k.focusNext(this.display_list,this.active,t)},focusPrev:function(){return k.focusPrev(this.display_list,this.active,!1)},activeIsLastFocusable:function(){for(var t=this.display_list.indexOf(this.active),e=this.display_list.length;0<e--&&!this.display_list[e].flag_focusable;);return t==e},onKey:function(t){switch(t){case"esc":this.callback("escape");break;case"tab":if(0==B._TAB_LEVEL)return;this.activeIsLastFocusable()?this.flag_lock_focus?this.focusNext(!0):"exit"==B._TAB_TYPE?this.callback_wm("focus_next",this):this.focusNext(!0):this.focusNext(!0);break;default:if(null==this.active)return;if(!this.active.flag_lock_focus){if("up"==t&&this.focusPrev())return;if("down"==t&&this.focusNext())return;if("home"==t||"pageup"==t)return void k.focusNext(this.display_list,null,!1);if("end"==t||"pagedown"==t)return void k.focusPrev(this.display_list,null,!1)}if("backsp"==t&&this.flag_close_on_bksp)return void this.close();this.active.onKey(t)}},onElementCallback:function(t,e){null!=B.onElementCallback&&B.onElementCallback(t,e),"focus"==t&&(null!=this.active&&this.active.unfocus(),this.active_last=this.active,this.active=e),this.callback(t,e)},set_style:function(t){return this.style==t?t:(this.style=t,this.setColor(null,this.style.text,this.style.bg),this.border_el.setColor(this.style.borderColor),this.set_borderStyle(this.style.borderStyle),this.style)},set_borderStyle:function(t){return this.borderStyle=t,this.borderStyle>P.border.length-1&&(this.borderStyle=1),this.border_el.style=this.borderStyle,this.style.borderStyle=this.borderStyle,this.visible&&!this.lockDraw&&(this.border_el.draw(),null!=this.title_el&&this.title_el.draw()),this.padding(this.rPadX,this.rPadY),t},set_visible:function(t){if(this.visible!=t)for(var e=0,s=this.display_list;e<s.length;){var i=s[e];++e,i.set_visible(t)}return this.visible=t},get_inWidth:function(){return this.width-this.padX-this.padX|0},get_inHeight:function(){return this.height-this.padY-this.padY|0},set_title:function(t){return this.title=t,this.lockDraw=!0,null!=this.title_el&&this.removeChild(this.title_el),this.title_el=new W("| "+this.title+" |"),this.title.length>this.get_inWidth()-4&&this.title_el.setTextWidth(this.get_inWidth()-4,"center"),this.title_el.setColor(this.style.titleColor),this.title_el.pos(this.x+(this.width/2-this.title_el.width/2|0),this.y),this.addChild(this.title_el),this.lockDraw=!1,this.visible&&(this.border_el.drawTop(),this.title_el.draw()),t},__class__:I,__properties__:i(k.prototype.__properties__,{get_inHeight:"get_inHeight",get_inWidth:"get_inWidth",set_style:"set_style",set_borderStyle:"set_borderStyle",set_title:"set_title"})});var O=function(t,e){this.SID=t,this.list=null!=e?e:[]};O.__name__="djTui.WindowState",O.prototype={add:function(t){return this.list.push(t),t},addM:function(t){for(var e=0;e<t.length;){var s=t[e];++e,this.add(s)}},get:function(t){for(var e=0,s=this.list;e<s.length;){var i=s[e];if(++e,i.SID==t)return i}return null},close:function(){for(var t=0,e=this.list;t<e.length;){var s=e[t];++t,s.close()}null!=this.lastBgColor&&(B.set_backgroundColor(this.lastBgColor),this.lastBgColor=null)},open:function(t){null!=this.bgColor&&(this.lastBgColor=B.backgroundColor,B.set_backgroundColor(this.bgColor));for(var e=0,s=this.list;e<s.length;){var i=s[e];++e,i.open()}k.focusNext(this.list,null)},__class__:O};var L=function(){this.clear()};L.__name__="djTui.WindowStateManager",L.prototype={store:function(t){var e=t.SID,s=this.states;if(null!=xt[e]?!s.existsReserved(e):!s.h.hasOwnProperty(e)){var i=t.SID,n=this.states;null!=xt[i]?n.setReserved(i,t):n.h[i]=t}},create:function(t,e){var s=new O(t,e);return this.store(s),s},close:function(){null!=this.current&&(this.current.close(),this.onStateClose(this.current),this.current=null)},goto:function(t,e){var s=this.states,i=null!=xt[t]?s.getReserved(t):s.h[t];null!=i&&this.open(i)},open:function(t){this.close(),this.onStateOpen(t),t.open(),this.current=t},onStateOpen:function(t){},onStateClose:function(t){},clear:function(){this.states=new at,this.current=null},handleESC:function(){return null!=this.current&&null!=this.current.onEscGoto&&(this.goto(this.current.onEscGoto),!0)},__class__:L};var D=function(){};D.__name__="djTui.adaptors.IInput",D.prototype={__class__:D};var R=function(){};R.__name__="djTui.adaptors.ITerminal",R.prototype={__class__:R};var C=function(){};C.__name__="djTui.adaptors.djNode.InputObj",C.__interfaces__=[D],C.prototype={_onKey:function(t){var e=f.toKeyCodeID(t);if(null!=e){var s;switch(e._hx_index){case 0:s="up";break;case 1:s="down";break;case 2:s="left";break;case 3:s="right";break;case 4:s="home";break;case 7:s="end";break;case 8:s="pageup";break;case 9:s="pagedown";break;case 10:s="backsp";break;case 11:s="tab";break;case 12:s="enter";break;case 13:s="space";break;case 14:s="esc";break;case 17:s="F1";break;case 18:s="F2";break;case 19:s="F3";break;case 20:s="F4";break;case 21:s="F5";break;default:s=""}this.onKey(s)}else this.onKey(t)},start:function(){p.startCapture(!0,pt(this,this._onKey))},stop:function(){p.stop()},__class__:C};var F=function(){this.t=o.TERMINAL,this.MAX_WIDTH=this.t.getWidth(),this.MAX_HEIGHT=this.t.getHeight()};F.__name__="djTui.adaptors.djNode.TerminalObj",F.__interfaces__=[R],F.prototype={saveCursor:function(){this.t;process.stdout.write("[s")},restoreCursor:function(){this.t;process.stdout.write("[u")},setCursorSymbol:function(t){},print:function(t){return process.stdout.write(j.string(t)),this},move:function(t,e){return this.t.move(t+1,e+1),this},moveR:function(t,e){if(0<t){this.t;process.stdout.write("["+t+"C")}else if(t<0){this.t;process.stdout.write("["+-t+"D")}if(0<e){this.t;process.stdout.write("["+e+"B")}else if(e<0){this.t;process.stdout.write("["+-e+"A")}return this},fg:function(t){return this.t.fg(t),this},bg:function(t){return this.t.bg(t),this},resetFG:function(){this.t;return process.stdout.write("[39m"),this},resetBG:function(){this.t;return process.stdout.write("[49m"),this},reset:function(){this.t;return process.stdout.write("[0m"),this},bold:function(t){if(t)this.t.bold();else{this.t;process.stdout.write("[21m")}return this},italics:function(t){return this},__class__:F};var M=function(t){this.s_padOut=0,this.s_padIn=0,this.disabled=!1,k.call(this,t),this.textAlign="center",this.textWidth=0};M.__name__="djTui.el.BaseMenuItem",M.__super__=k,M.prototype=i(k.prototype,{disable:function(t,e){return null==e&&(e=!1),null==t&&(t=!0),this.set_disabled(t),e&&t?this.flag_focusable=!1:t||(this.flag_focusable=!0),this},onAdded:function(){null==this.color_idle&&(this.color_idle=this.parent.style.elem_idle),null==this.color_focus&&(this.color_focus=this.parent.style.elem_focus),1==this.disabled&&this.set_disabled(!0)},focusSetup:function(t){t?this.setColor(this.color_focus):this.setColor(this.color_idle)},colorIdle:function(t,e){return this.color_idle={fg:t,bg:e},this.colorChangeDraw(),this},colorFocus:function(t,e){return this.color_focus={fg:t,bg:e},this.colorChangeDraw(),this},colorChangeDraw:function(){null!=this.parent&&(this.focusSetup(this.isFocused),this.visible&&!this.lockDraw&&this.draw())},draw:function(){B.T.reset().fg(this.colorFG).bg(this.colorBG),B.T.move(this.x,this.y).print(this.rText)},set_text:function(t){return null==t&&(t=""),this.text=t,null!=this.s_smb_l&&(t=this.s_smb_l+A.empty(this.s_padIn)+t+A.empty(this.s_padIn)+this.s_smb_r),0<this.s_padOut&&(t=A.empty(this.s_padOut)+t+A.empty(this.s_padOut)),null!=this.rText&&0==this.textWidth&&it.__cast(t,String).length<this.rText.length&&this.visible&&this.clear(),0==this.textWidth?this.rText=t:this.rText=A.padString(t,this.textWidth,this.textAlign),this.width=this.rText.length,this.visible&&!this.lockDraw&&this.draw(),this.text},setTextWidth:function(t,e){return null==e&&(e="left"),this.textWidth=t,this.textAlign=e,null!=this.text&&this.set_text(this.text),this},set_disabled:function(t){if(this.disabled=t,this.disabled||(this.flag_focusable=!0),null!=this.parent){var e=this.parent.style;this.disabled?(this.color_focus=e.elem_disable_f,this.color_idle=e.elem_disable_i):(this.color_idle=e.elem_idle,this.color_focus=e.elem_focus),this.colorChangeDraw()}return t},setSideSymbolPad:function(t,e){return this.s_padIn=e,this.s_padOut=t,null!=this.text&&this.set_text(this.text),this},setSideSymbols:function(t,e){null==e&&(e=" "),null==t&&(t=" "),this.s_smb_l=t,this.s_smb_r=e},__class__:M,__properties__:i(k.prototype.__properties__,{set_disabled:"set_disabled",set_text:"set_text"})});var G=function(t,e){null==e&&(e=0),k.call(this,t),this.flag_focusable=!1,this.style=e};G.__name__="djTui.el.Border",G.__super__=k,G.prototype=i(k.prototype,{drawTop:function(){B.T.reset().fg(this.colorFG).bg(this.colorBG),B.D.lineH(this.x+1,this.y,this.width-2,P.border[this.style].charAt(1))},draw:function(){B.T.reset().fg(this.colorFG).bg(this.colorBG),B.D.border(this.x,this.y,this.width,this.height,this.style)},__class__:G});var H=function(t,e,s,i){if(null==i&&(i=0),null==s&&(s=0),this.flag_leftright_escape=!1,M.call(this,t),this.type=E.button,this.height=1,this.textWidth=i,0<s){var n=s-1;this.setSideSymbolPad(1,1),this.setSideSymbols(H.SMB[n].charAt(0),H.SMB[n].charAt(1))}this.set_text(e),null!=t&&0<=["#","@"].indexOf(t.charAt(0))&&this.extra(t)};H.__name__="djTui.el.Button",H.__super__=M,H.prototype=i(M.prototype,{extra:function(t){var e=t.split(",");null==this.xtr&&(this.xtr={});for(var s=0;s<e.length;){var i=e[s];++s;var n=i.charAt(0),r=g.substr(i,1,null);switch(n){case"#":this.xtr.call=0,this.xtr.sid=r;break;case"?":this.xtr.conf=!0,this.xtr.confQ=r,N.isEmpty(this.xtr.confQ)&&(this.xtr.confQ=H.CONF_DEF);break;case"@":this.xtr.call=1,this.xtr.sid=r;break;case"x":this.xtr.x=j.parseInt(r);break;case"y":this.xtr.y=j.parseInt(r);break;default:switch(i){case"anim":this.xtr.anim=!0;break;case"center":this.xtr.center=!0;break;case"close":this.xtr.close=!0}}}return this},confirm:function(t,e){var s="?";return null!=t&&(s+=t),null!=e&&(s+=",center"),this.extra(s)},action:function(){if(null!=this.xtr){if(null!=this.xtr.call&&0==this.xtr.call)return void B.STATE.goto(this.xtr.sid);if(null!=this.xtr.close&&this.parent.close(),null!=this.xtr.call&&1==this.xtr.call){var t=this.xtr.sid,e=B.DB,s=null!=xt[t]?e.getReserved(t):e.h[t];null!=s&&(null!=this.xtr.x&&null!=this.xtr.y?s.pos(this.xtr.x,this.xtr.y):null!=this.xtr.center&&B.A.screen(s),null!=this.xtr.anim?s.openAnimated():s.open(!0))}}this.callback("fire"),null!=this.extra_onPush&&this.extra_onPush()},onKey:function(t){"enter"!=t&&"space"!=t||this.disabled?this.flag_leftright_escape&&("left"==t?this.parent.focusPrev():"right"==t&&this.parent.focusNext()):null!=this.xtr&&null!=this.xtr.conf?B.popupConfirm(pt(this,this.action),this.xtr.confQ,null==this.xtr.center?[this.x,this.y+1]:null):this.action()},getData:function(){return this.SID},onPush:function(t){return this.extra_onPush=t,this},__class__:H});var W=function(t,e,s){null==s&&(s="left"),null==e&&(e=0),null==t&&(t=""),M.call(this),this.type=E.label,this.flag_focusable=!1,this.textWidth=e,this.textAlign=s,this.height=1,this.set_text(t),this.anim_blink=!1,this.anim_scroll=0};W.__name__="djTui.el.Label",W.__super__=M,W.prototype=i(M.prototype,{setSID:function(t){return this.SID=t,this},onAdded:function(){M.prototype.onAdded.call(this),null==this.colorFG?this.setColor(null,this.parent.colorFG):null==this.colorBG&&(this.colorBG=this.parent.colorBG)},scroll:function(t){null==t&&(t=200);var s=this;this.stop();var e=pt(this,this.scroll),i=t;return this.anim_active_call=function(){return e(i)},this.visible&&(this.timer=new Q(t),this.timer.run=function(){s.anim_scroll++,s.anim_scroll>=s.text.length&&(s.anim_scroll=0);for(var t=0,e=[];t<s.width;)e[t]=s.text.charAt((s.anim_scroll+t)%s.text.length),++t;s.rText=e.join(""),s.draw()},this.timer.run()),this},blink:function(t){null==t&&(t=300);var e=this;this.stop();var s=pt(this,this.blink),i=t;return this.anim_active_call=function(){return s(i)},this.visible&&(this.timer=new Q(t),this.timer.run=function(){e.anim_blink=!e.anim_blink,e.anim_blink?e.rText=A.padString(e.text,e.width):e.rText=A.padString("",e.width),e.draw()},this.timer.run()),this},blinkOff:function(){this.stop(),this.rText=A.padString("",this.width),this.anim_blink=!1,this.draw()},stop:function(){(this.anim_active_call=null)!=this.timer&&(this.timer.stop(),this.timer=null)},reset:function(){this.set_text(""),this.stop()},set_visible:function(t){return this.visible==t||(this.visible=t,this.visible?null!=this.anim_active_call&&this.anim_active_call():null!=this.timer&&(this.timer.stop(),this.timer=null)),t},set_text:function(t){return M.prototype.set_text.call(this,t),null==t?null:(this.visible&&null!=this.anim_active_call&&this.anim_active_call(),this.text)},setData:function(t){this.set_text(t)},getData:function(){return this.text},__class__:W});var K=function(t){null==t&&(t=8),this.scroll_ratio=0,k.call(this),this.height=t,this.flag_focusable=!1};K.__name__="djTui.el.ScrollBar",K.__super__=k,K.prototype=i(k.prototype,{onAdded:function(){k.prototype.onAdded.call(this),null==this.colorFG&&this.setColor(this.parent.style.scrollbar_idle)},set_scroll_ratio:function(t){return this.scroll_ratio==t?t:(this.scroll_ratio=t,this.scroll_ratio<0?this.scroll_ratio=0:1<this.scroll_ratio&&(this.scroll_ratio=1),this.visible&&!this.lockDraw&&this.draw(),this.scroll_ratio)},draw:function(){B.T.reset().fg(this.colorFG).bg(this.colorBG);for(var t=0,e=this.height;t<e;){var s=t++;B.T.move(this.x,this.y+s).print(K.SYMBOL_BAR)}var i=Math.ceil(this.height*this.scroll_ratio)-1;i<0&&(i=0),B.T.move(this.x,this.y+i).print(K.SYMBOL_IND)},__class__:K,__properties__:i(k.prototype.__properties__,{set_scroll_ratio:"set_scroll_ratio"})});var z=function(t,e,s){null==s&&(s=0),this.flag_scrollbar_autohide=!0,this.flag_add_scrollbar=!1,k.call(this,t),this.type=E.textbox,this.size(e-1,s),this.slots_count=this.height,this.reset(),this.flag_lock_focus=!0};z.__name__="djTui.el.TextBox",z.__super__=k,z.prototype=i(k.prototype,{get_linesCount:function(){return this.lines.length},onKey:function(t){if(this.flag_empty)"up"==t?this.parent.focusPrev():"down"==t&&this.parent.focusNext();else switch(t){case"down":this.scroll_offset==this.scroll_max?this.parent.focusNext():this.scrollDown();break;case"end":this.scrollBottom();break;case"home":this.scrollTop();break;case"left":this.parent.focusPrev();break;case"pagedown":this.scrollPageDown();break;case"pageup":this.scrollPageUp();break;case"right":this.parent.focusNext();break;case"up":0==this.scroll_offset?this.parent.focusPrev():this.scrollUp()}},onAdded:function(){null==this.colorFG&&this.setColor(this.parent.style.textbox),this.flag_add_scrollbar&&this.addScrollbar()},focusSetup:function(t){null!=this.parent.style.textbox_focus&&(t?this.setColor(this.parent.style.textbox_focus):this.setColor(this.parent.style.textbox)),null!=this.scrollbar&&(this.flag_scrollbar_autohide&&!t?(this.scrollbar.setColor(null,this.colorBG,this.colorBG),this.scrollbar.draw()):null!=this.parent.style.scrollbar_focus&&(t?this.scrollbar.setColor(this.parent.style.scrollbar_focus):this.scrollbar.setColor(this.parent.style.scrollbar_idle),this.scrollbar.draw()))},draw:function(){B.T.reset().fg(this.colorFG).bg(this.colorBG);for(var t=0;;){if(null==this.lines[t+this.scroll_offset]){B.D.rect(this.x,this.y+t,this.width,this.slots_count-t);break}if(this.drawSlotIndex(t),!(++t<this.slots_count))break}},drawSlotIndex:function(t){B.T.move(this.x,this.y+t).print(this.lines[t+this.scroll_offset])},addLine:function(t){this.flag_empty=!1,this.lines.push(A.padString(t,this.width)),this.scroll_max=this.lines.length-this.slots_count,this.scroll_max<0&&(this.scroll_max=0),0<this.scroll_max&&(this.addScrollbar(),this.set_scroll_offset(this.scroll_offset)),this.visible&&this.draw()},addScrollbar:function(){null==this.scrollbar&&(null!=this.parent?(this.scrollbar=new K(this.height),this.scrollbar.posNext(this),this.parent.addChild(this.scrollbar),this.focusSetup(this.isFocused),this.flag_add_scrollbar=!1):this.flag_add_scrollbar=!0)},setData:function(t){var e;if(this.reset(),"string"==typeof t)e=A.splitToLines(t,this.width);else{if(!(t instanceof Array&&null==t.__enum__))throw new st("Unsupported Data Type for Textbox");e=t}for(var s=0;s<e.length;){var i=e[s];++s,this.lines.push(A.padString(i,this.width))}0==this.height&&(this.height=e.length,this.slots_count=this.height),this.scroll_max=this.lines.length-this.slots_count,this.scroll_max<0&&(this.scroll_max=0),0<this.scroll_max&&this.addScrollbar(),this.flag_empty=0==this.lines.length,this.visible&&!this.lockDraw&&this.draw()},set_scroll_offset:function(t){return t<0&&(t=0),t>this.scroll_max&&(t=this.scroll_max),this.scroll_offset=t,this.scroll_ratio=this.scroll_offset/this.scroll_max,null!=this.scrollbar&&this.scrollbar.set_scroll_ratio(this.scroll_ratio),this.visible&&!this.lockDraw&&this.draw(),this.callback("scroll"),t},reset:function(){this.lines=[],this.set_scroll_offset(0),this.scroll_ratio=0,this.flag_empty=!0,null!=this.scrollbar&&(this.parent.removeChild(this.scrollbar),this.scrollbar.clear(),this.scrollbar=null),this.visible&&this.draw()},scrollUp:function(){this.set_scroll_offset(this.scroll_offset-1)},scrollDown:function(){this.set_scroll_offset(this.scroll_offset+1)},scrollPageUp:function(){this.set_scroll_offset(this.scroll_offset-Math.floor(this.slots_count/2))},scrollPageDown:function(){this.set_scroll_offset(this.scroll_offset+Math.floor(this.slots_count/2))},scrollTop:function(){this.set_scroll_offset(0)},scrollBottom:function(){this.set_scroll_offset(this.scroll_max)},__class__:z,__properties__:i(k.prototype.__properties__,{get_linesCount:"get_linesCount",set_scroll_offset:"set_scroll_offset"})});var U=function(t,e,s){this.flag_ghost_active=!1,this.flag_letter_jump=!1,this.scrollPad=1,z.call(this,t,e,s),this.type=E.vlist,this.flag_focusable=!0};U.__name__="djTui.el.VList",U.__super__=z,U.prototype=i(z.prototype,{onAdded:function(){z.prototype.onAdded.call(this),this.scrollPad>Math.floor(this.slots_count/2)-1&&(this.scrollPad=Math.floor(this.slots_count/2)-1),null==this.color_cursor&&(this.color_cursor=this.parent.style.vlist_cursor)},setColorCursor:function(t,e){this.color_cursor={fg:t,bg:e}},draw:function(){z.prototype.draw.call(this),this.isFocused&&!this.flag_empty&&this.cursor_draw(),!this.isFocused&&this.flag_ghost_active&&(B.T.reset().fg(this.parent.style.elem_disable_f.fg).bg(this.parent.style.elem_disable_f.bg),this.drawSlotIndex(this.index_slot))},onKey:function(t){if(this.flag_empty)z.prototype.onKey.call(this,t);else switch(t){case"down":this.index==this.get_index_max()?this.parent.focusNext():this.cursor_down();break;case"end":this.cursor_bottom();break;case"enter":this.callback("fire"),null!=this.onSelect&&this.onSelect(this.index);break;case"home":this.cursor_top();break;case"left":this.parent.focusPrev();break;case"pagedown":this.cursor_pageDown();break;case"pageup":this.cursor_pageUp();break;case"right":this.parent.focusNext();break;case"space":this.callback("fire"),null!=this.onSelect&&this.onSelect(this.index);break;case"up":0==this.index?this.parent.focusPrev():this.cursor_up();break;default:if(!this.flag_letter_jump)return;if(t=t.toUpperCase(),this.lines[this.index].charAt(0).toUpperCase()==t&&null!=this.lines[this.index+1]&&this.lines[this.index+1].charAt(0).toUpperCase()==t)return void this.cursor_down();for(var e=0;;){if(this.lines[e].charAt(0).toUpperCase()==t)return void this.cursor_to(e);if(!(++e<this.lines.length))break}}},reset:function(){z.prototype.reset.call(this),this.index=0,this.index_slot=0},getData:function(){return this.index},add:function(t){return this.addLine(t),this.get_index_max()},getSelectedText:function(){return null!=this.lines[this.index]?this.lines[this.index]:""},cursor_to:function(t){if(t!=this.index){for(null!=this.scrollbar&&(this.scrollbar.lockDraw=!0),this.lockDraw=!0,this.cursor_top();this.index<t;)this.cursor_down();this.lockDraw=!1,this.visible&&this.draw(),null!=this.scrollbar&&(this.scrollbar.lockDraw=!1,this.visible&&this.scrollbar.draw())}},cursor_draw:function(){this.lockDraw||(B.T.reset().fg(this.color_cursor.fg).bg(this.color_cursor.bg),this.drawSlotIndex(this.index_slot))},draw_current_slot_unfocused:function(){this.lockDraw||(B.T.reset().fg(this.colorFG).bg(this.colorBG),this.drawSlotIndex(this.index_slot))},cursor_up:function(){0!=this.index&&(this.index--,this.index_slot<=this.scrollPad&&0<this.scroll_offset?this.scrollUp():(this.draw_current_slot_unfocused(),this.index_slot--),this.cursor_draw(),this.callback("change"))},cursor_down:function(){this.index!=this.get_index_max()&&(this.index++,this.index_slot>=this.slots_count-this.scrollPad-1&&this.scroll_offset<this.scroll_max?this.scrollDown():(this.draw_current_slot_unfocused(),this.index_slot++),this.cursor_draw(),this.callback("change"))},cursor_top:function(){0!=this.index&&((this.index=0)==this.scroll_offset?(this.draw_current_slot_unfocused(),this.index_slot=0,this.cursor_draw()):(this.index_slot=0,this.scrollTop()),this.callback("change"))},cursor_bottom:function(){this.index!=this.get_index_max()&&(this.index=this.get_index_max(),this.scroll_offset==this.scroll_max?(this.draw_current_slot_unfocused(),this.lines.length<this.slots_count?this.index_slot=this.get_index_max():this.index_slot=this.slots_count-1,this.cursor_draw()):(this.index_slot=this.slots_count-1,this.scrollBottom()),this.callback("change"))},cursor_pageUp:function(){if(0!=this.index){if(this.index_slot>this.scrollPad&&0<this.scroll_offset)this.draw_current_slot_unfocused(),this.index_slot=this.scrollPad,this.index=this.scroll_offset+this.index_slot,this.cursor_draw();else{if(0==this.scroll_offset)return void this.cursor_top();this.index_slot=this.scrollPad,this.scrollPageUp(),this.index=this.scroll_offset+this.index_slot}this.callback("change")}},cursor_pageDown:function(){if(this.index!=this.get_index_max()){if(this.index_slot<this.slots_count-this.scrollPad-1&&this.scroll_offset<this.scroll_max)this.draw_current_slot_unfocused(),this.index_slot=this.slots_count-this.scrollPad-1,this.index=this.scroll_offset+this.index_slot,this.cursor_draw();else{if(this.scroll_offset==this.scroll_max)return void this.cursor_bottom();this.index_slot=this.slots_count-1-this.scrollPad,this.scrollPageDown(),this.index=this.scroll_offset+this.index_slot}this.callback("change")}},get_index_max:function(){return this.lines.length-1},__class__:U,__properties__:i(z.prototype.__properties__,{get_index_max:"get_index_max"})});var Y=function(t,e,s){null==s&&(s=0),null==e&&(e=1),this._gStyle=0,this._bStyle=0,this._bFixSize=0,I.call(this,t,e,1),this.padX=s,this.setPanelStyle(this.style.text,this.style.bg),this.setItemStyle()};Y.__name__="djTui.win.MenuBar",Y.__super__=I,Y.prototype=i(I.prototype,{setItemStyle:function(t,e,s,i,n,r){null==r&&(r=1),null==n&&(n=1),null==i&&(i=1),null==s&&(s=0),null==e&&(e=0),null==t&&(t="left"),this.menuAlign=t,this._bFixSize=e,this._bStyle=s,this._bPad0=i,this._bPad1=n,this._bPad2=r},setPanelStyle:function(t,e,s){null==s&&(s=-1),-1==(this._gStyle=s)?(this.padY=0,this.height=1):(this.padY=1,this.height=3,0<s&&0==this.padX&&(this.padX=1)),this.modifyStyle({borderStyle:0,bg:e,elem_idle:{fg:t},elem_focus:{fg:e,bg:t}})},setItems:function(t){if(null==t)return this;if(this.currentIndex=0,null!=this.items){this.lockDraw=!0;for(var e=0,s=this.items;e<s.length;){var i=s[e];++e,this.removeChild(i)}this.lastAdded=null,this.lockDraw=!1}this.items=[],this._gSizes=[];for(var n=0,r=0;r<t.length;){var o=new H(""+r,t[r],this._bStyle,this._bFixSize);o.setSideSymbolPad(this._bPad0,this._bPad1),this.items.push(o),++r,this._gSizes.push(o.width+this._bPad2),n+=o.width+this._bPad2}return this._gSizes[0]++,this._gSizes.push(this.height),(n-=this._bPad2)+2*this.padX>this.width&&(this.width=n+2*this.padX),this.addStackInline(this.items,0,this._bPad2,this.menuAlign),this},onElementCallback:function(t,e){I.prototype.onElementCallback.call(this,t,e),"fire"==t&&null!=this.onSelect?this.onSelect(this.currentIndex):"focus"==t?(this.currentIndex=j.parseInt(e.SID),0==this._gStyle&&this.drawThick(this.active),null!=this.onChange&&this.onChange(this.currentIndex)):"unfocus"==t&&0==this._gStyle&&this.drawThick(this.items[j.parseInt(e.SID)])},draw:function(){I.prototype.draw.call(this),0<this._gStyle&&(B.T.reset().fg(this.colorFG).bg(this.colorBG),B.D.drawGrid(this.items[0].x-1,this.y,null,[this._gSizes.slice()],this._gStyle,this._gStyle))},drawThick:function(t){B.T.bg(t.colorBG),B.D.rect(t.x,t.y+1,t.width,1),B.D.rect(t.x,t.y-1,t.width,1)},setCursor:function(t){t!=this.currentIndex&&(this.currentIndex=t,0<this.currentIndex&&this.items[this.currentIndex].focus())},setData:function(t){this.setItems(it.__cast(t,String).split(","))},getIndex:function(){return this.currentIndex},__class__:Y});var X=function(t,e,s,i,n){switch(null==i&&(i=30),this.flag_auto_close=!0,null==n&&(n=B.global_style_pop),I.call(this,null,null,null,n),this.mbType=e,this.resultCallback=s,this.flag_lock_focus=!0,this.padding(1,0),this.tbox=new z(null,i-2*this.padX,0),this.tbox.setData(t),this.tbox.flag_focusable=!1,this.buttons=[],this.mbType){case 0:this.add_b("OK");break;case 1:this.add_b("OK"),this.add_b("CANCEL");break;case 2:this.add_b("YES"),this.add_b("NO")}this.size(i,this.tbox.height+5),this.addStack(this.tbox,1),this.addStackInline(this.buttons,1,3,"center"),X.FOCUS_LAST&&null!=this.lastAdded&&(this.hack_always_focus_this=this.lastAdded.SID)};X.__name__="djTui.win.MessageBox",X.create=function(t,e,s,i,n,r){null==r&&(r=!1),null==i&&(i=30);var o=new X(t,e,s,i,n);return B.A.screen(o),r?o.openAnimated():o.open(!0),o},X.__super__=I,X.prototype=i(I.prototype,{onElementCallback:function(t,e){I.prototype.onElementCallback.call(this,t,e),"fire"==t&&(this.flag_auto_close&&this.close(),null!=this.resultCallback&&this.resultCallback(this.buttons.indexOf(e)))},add_b:function(t){var e=new H(null,t,X.BUTTON_STYLE);e.flag_leftright_escape=!0,this.buttons.push(e)},__class__:X});var q=function(){};q.__name__="haxe.IMap";var Z=function(){};Z.__name__="haxe.Log",Z.formatOutput=function(t,e){var s=j.string(t);if(null==e)return s;var i=e.fileName+":"+e.lineNumber;if(null!=e&&null!=e.customParams)for(var n=0,r=e.customParams;n<r.length;){var o=r[n];++n,s+=", "+j.string(o)}return i+": "+s},Z.trace=function(t,e){var s=Z.formatOutput(t,e);"undefined"!=typeof console&&null!=console.log&&console.log(s)};var Q=function(t){var e=this;this.id=setInterval(function(){e.run()},t)};Q.__name__="haxe.Timer",Q.delay=function(t,e){var s=new Q(e);return s.run=function(){s.stop(),t()},s},Q.prototype={stop:function(){null!=this.id&&(clearInterval(this.id),this.id=null)},run:function(){},__class__:Q};var at=function(){this.h={}};at.__name__="haxe.ds.StringMap",at.__interfaces__=[q],at.prototype={setReserved:function(t,e){null==this.rh&&(this.rh={}),this.rh["$"+t]=e},getReserved:function(t){return null==this.rh?null:this.rh["$"+t]},existsReserved:function(t){return null!=this.rh&&this.rh.hasOwnProperty("$"+t)},__class__:at};var J=function(t){this.length=t.byteLength,this.b=new Uint8Array(t),(this.b.bufferValue=t).hxBytes=this,t.bytes=this.b};J.__name__="haxe.io.Bytes",J.prototype={__class__:J};b["haxe.io.Encoding"]={__ename__:!0,__constructs__:["UTF8","RawNative"],UTF8:{_hx_index:0,__enum__:"haxe.io.Encoding",toString:s},RawNative:{_hx_index:1,__enum__:"haxe.io.Encoding",toString:s}};var $=function(){};$.__name__="haxe.io.Eof",$.prototype={toString:function(){return"Eof"},__class__:$};var tt=b["haxe.io.Error"]={__ename__:!0,__constructs__:["Blocked","Overflow","OutsideBounds","Custom"],Blocked:{_hx_index:0,__enum__:"haxe.io.Error",toString:s},Overflow:{_hx_index:1,__enum__:"haxe.io.Error",toString:s},OutsideBounds:{_hx_index:2,__enum__:"haxe.io.Error",toString:s},Custom:(t=function(t){return{_hx_index:3,e:t,__enum__:"haxe.io.Error",toString:s}},t.__params__=["e"],t)},et=function(){this.settings=new at};et.__name__="hxconf.ConfigFile",et.prototype={read:function(t){for(var e=t.split("\n"),s="",i=null,n=0;n<e.length;){var r=e[n];if(++n,0!=(r=V.trim(r)).length&&!et.comment.match(r))if(et.section.match(r))s=et.section.matched(1);else if(et.def.match(r)){var o=this.settings;if(!(null!=xt[s]?o.existsReserved(s):o.h.hasOwnProperty(s))){var l=this.settings,a=new at,h=l;null!=xt[s]?h.setReserved(s,a):h.h[s]=a}var c=this.settings,u=null!=xt[s]?c.getReserved(s):c.h[s],_=et.def.matched(1),d=et.def.matched(2),f=u;null!=xt[_]?f.setReserved(_,d):f.h[_]=d,i=et.def.matched(1)}else{if(null==i)throw new st("Config formatting error");var p=i,g=this.settings,m=null!=xt[s]?g.getReserved(s):g.h[s],v=(null!=xt[p]?m.getReserved(p):m.h[p])+" "+r;null!=xt[p]?m.setReserved(p,v):m.h[p]=v}}},exists:function(t,e){var s=this.settings;if(null!=xt[t]?s.existsReserved(t):s.h.hasOwnProperty(t)){var i=this.settings,n=null!=xt[t]?i.getReserved(t):i.h[t];return null!=xt[e]?n.existsReserved(e):n.h.hasOwnProperty(e)}return!1},get:function(t,e){var s=this.settings,i=null!=xt[t]?s.getReserved(t):s.h[t];return null!=xt[e]?i.getReserved(e):i.h[e]},getAll:function(t){var e=this.settings;return null!=xt[t]?e.getReserved(t):e.h[t]},__class__:et};var st=function(t){Error.call(this),this.val=t,Error.captureStackTrace&&Error.captureStackTrace(this,st)};st.__name__="js._Boot.HaxeError",st.__super__=Error,st.prototype=i(Error.prototype,{__class__:st});var it=function(){};it.__name__="js.Boot",it.getClass=function(t){if(t instanceof Array&&null==t.__enum__)return Array;var e=t.__class__;if(null!=e)return e;var s=it.__nativeClassName(t);return null!=s?it.__resolveNativeClass(s):null},it.__string_rec=function(t,e){if(null==t)return"null";if(5<=e.length)return"<...>";var s=typeof t;switch("function"==s&&(t.__name__||t.__ename__)&&(s="object"),s){case"function":return"<function>";case"object":if(t.__enum__){var i=b[t.__enum__],n=i.__constructs__[t._hx_index],r=i[n];if(r.__params__){e+="\t";for(var o=n+"(",l=[],a=0,h=r.__params__;a<h.length;){var c=h[a];++a,l.push(it.__string_rec(t[c],e))}return o+l.join(",")+")"}return n}if(t instanceof Array){var u="[";e+="\t";for(var _=0,d=t.length;_<d;){var f=_++;u+=(0<f?",":"")+it.__string_rec(t[f],e)}return u+="]"}var p;try{p=t.toString}catch(t){t instanceof st&&t.val;return"???"}if(null!=p&&p!=Object.toString&&"function"==typeof p){var g=t.toString();if("[object Object]"!=g)return g}var m=null,v="{\n";e+="\t";var w=null!=t.hasOwnProperty;for(var m in t)w&&!t.hasOwnProperty(m)||"prototype"!=m&&"__class__"!=m&&"__super__"!=m&&"__interfaces__"!=m&&"__properties__"!=m&&(2!=v.length&&(v+=", \n"),v+=e+m+" : "+it.__string_rec(t[m],e));return v+="\n"+(e=e.substring(1))+"}";case"string":return t;default:return String(t)}},it.__interfLoop=function(t,e){if(null==t)return!1;if(t==e)return!0;var s=t.__interfaces__;if(null!=s)for(var i=0,n=s.length;i<n;){var r=s[i++];if(r==e||it.__interfLoop(r,e))return!0}return it.__interfLoop(t.__super__,e)},it.__instanceof=function(t,e){if(null==e)return!1;switch(e){case Array:return t instanceof Array&&null==t.__enum__;case wt:return"boolean"==typeof t;case mt:return null!=t;case vt:return"number"==typeof t;case gt:return"number"==typeof t&&(0|t)===t;case String:return"string"==typeof t;default:if(null==t)return!1;if("function"==typeof e){if(t instanceof e)return!0;if(it.__interfLoop(it.getClass(t),e))return!0}else if("object"==typeof e&&it.__isNativeObj(e)&&t instanceof e)return!0;return e==bt&&null!=t.__name__||(e==yt&&null!=t.__ename__||b[t.__enum__]==e)}},it.__cast=function(t,e){if(null==t||it.__instanceof(t,e))return t;throw new st("Cannot cast "+j.string(t)+" to "+j.string(e))},it.__nativeClassName=function(t){var e=it.__toStr.call(t).slice(8,-1);return"Object"==e||"Function"==e||"Math"==e||"JSON"==e?null:e},it.__isNativeObj=function(t){return null!=it.__nativeClassName(t)},it.__resolveNativeClass=function(t){return e[t]};var nt=require("child_process"),rt=require("crypto"),ot=require("fs"),lt=require("os"),ht=require("path"),ct=require("events").EventEmitter,ut=require("buffer").Buffer,_t=function(t){this.fd=t,this.pos=0};_t.__name__="sys.io.FileInput",_t.__super__=l,_t.prototype=i(l.prototype,{readByte:function(){var t,e=new ut(1);try{t=ot.readSync(this.fd,e,0,1,this.pos)}catch(t){var s=t instanceof st?t.val:t;throw"EOF"==s.code?new st(new $):new st(tt.Custom(s))}if(0==t)throw new st(new $);return this.pos++,e[0]},readBytes:function(t,e,s){var i,n=t.b,r=ut.from(n.buffer,n.byteOffset,t.length);try{i=ot.readSync(this.fd,r,e,s,this.pos)}catch(t){var o=t instanceof st?t.val:t;throw"EOF"==o.code?new st(new $):new st(tt.Custom(o))}if(0==i)throw new st(new $);return this.pos+=i,i},close:function(){ot.closeSync(this.fd)},seek:function(t,e){switch(e._hx_index){case 0:this.pos=t;break;case 1:this.pos+=t;break;case 2:this.pos=ot.fstatSync(this.fd).size+t}},tell:function(){return this.pos},eof:function(){return this.pos>=ot.fstatSync(this.fd).size},__class__:_t});var dt=function(t){this.fd=t,this.pos=0};dt.__name__="sys.io.FileOutput",dt.__super__=n,dt.prototype=i(n.prototype,{writeByte:function(t){var e=new ut(1);e[0]=t,ot.writeSync(this.fd,e,0,1,this.pos),this.pos++},writeBytes:function(t,e,s){var i=t.b,n=ut.from(i.buffer,i.byteOffset,t.length),r=ot.writeSync(this.fd,n,e,s,this.pos);return this.pos+=r,r},close:function(){ot.closeSync(this.fd)},seek:function(t,e){switch(e._hx_index){case 0:this.pos=t;break;case 1:this.pos+=t;break;case 2:this.pos=ot.fstatSync(this.fd).size+t}},tell:function(){return this.pos},__class__:dt});b["sys.io.FileSeek"]={__ename__:!0,__constructs__:["SeekBegin","SeekCur","SeekEnd"],SeekBegin:{_hx_index:0,__enum__:"sys.io.FileSeek",toString:s},SeekCur:{_hx_index:1,__enum__:"sys.io.FileSeek",toString:s},SeekEnd:{_hx_index:2,__enum__:"sys.io.FileSeek",toString:s}};var ft=0;function pt(t,e){return null==e?null:(null==e.__id__&&(e.__id__=ft++),null==t.hx__closures__?t.hx__closures__={}:s=t.hx__closures__[e.__id__],null==s&&(s=e.bind(t),t.hx__closures__[e.__id__]=s),s);var s}null==String.fromCodePoint&&(String.fromCodePoint=function(t){return t<65536?String.fromCharCode(t):String.fromCharCode(55232+(t>>10))+String.fromCharCode(56320+(1023&t))}),String.prototype.__class__=String,String.__name__="String",Array.__name__="Array",Date.prototype.__class__=Date,Date.__name__="Date";var gt={},mt={},vt=Number,wt=Boolean,bt={},yt={},xt={};Object.defineProperty(st.prototype,"message",{get:function(){return String(this.val)}}),u.extensions_mountable=["pfo","zip"],u.extensionsToSearch=["cue","m3u","zip","pfo"],u.extensionsToMount=["pfo","zip"],u.file_config="config.ini",u.file_config_empty="config_empty.ini",u.MEDNAFEN_EXE="mednafen.exe",u.PSIMO_EXE="PFM.exe",u.NAME="Mednafen PSX Custom Launcher",u.VER="0.4",h.WIDTH=80,h.HEIGHT=25,h.WIDTH_MIN=60,h.HEIGHT_MIN=20,h.STATUS_POPUP_TIME=3e3,f.CTRLC="",f.ESC="",f.UP="[A",f.DOWN="[B",f.LEFT="[C",f.RIGHT="[D",f.BACKSP="\b",f.TAB="\t",f.ENTER="\r",f.DELETE="",p.FLAG_CAN_BREAK=!0,m.ESCAPE_SEQ="[",m._BOLD="[1m",m._DIM="[2m",m._UNDERL="[4m",m._BLINK="[5m",m._HIDDEN="[8m",m._RESET_ALL="[0m",m._RESET_FG="[39m",m._RESET_BG="[49m",m._RESET_BOLD="[21m",m._RESET_DIM="[22m",m._RESET_UNDERL="[24m",m._RESET_BLINK="[25m",m._RESET_HIDDEN="[28m",m.AVAIL_COLORS=["black","white","gray","darkgray","red","darkred","green","darkgreen","blue","darkblue","cyan","darkcyan","magenta","darkmagenta","yellow","darkyellow"],m.DEFAULT_LINE_WIDTH=50,m.DEFAULT_LINE_SYMBOL="-",m.LIST_SYMBOL="*",m.H1_SYMBOL="#",m.H2_SYMBOL="+",m.H3_SYMBOL="=",w._isInited=!1,w.logLevel=0,w.flag_realtime_file=!0,w.flag_socket_log=!1,w.flag_keep_in_memory=!0,w.param_memory_buffer=8192,k.UID_GEN=1,P.DEF_STYLE_WIN="blue.1",P.DEF_STYLE_POP="red.1",P.DEF_WINDOW_SIZE_X=20,P.DEF_WINDOW_SIZE_Y=8,B.NAME="djTUI",B.VERSION="0.1",B.backgroundColor="black",B._isInited=!1,I.windowAnimationTick=90,H.SMB=["[]","{}","()","<>"],H.CONF_DEF="Are you sure?",K.SYMBOL_BAR="â”‚",K.SYMBOL_IND="â–ˆ",X.BUTTON_STYLE=1,X.FOCUS_LAST=!1,et.comment=new c("^#.*",""),et.section=new c("^\\[([^\\]]+)\\]",""),et.def=new c("^([^:=]+)[:=](.*)",""),it.__toStr={}.toString,h.main()}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);